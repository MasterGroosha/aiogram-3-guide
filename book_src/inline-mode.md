---
title: ÂÜÖËÅîÊ®°Âºè
description: ÂÜÖËÅîÊ®°Âºè
---

# ÂÜÖËÅîÊ®°Âºè

!!! info ""

    ‰ΩøÁî®ÁöÑ aiogram ÁâàÊú¨Ôºö 3.1.1

## ÁêÜËÆ∫ {: id="theory" }

### ‰∏∫‰ªÄ‰πàÈúÄË¶ÅÂÜÖËÅîÊ®°ÂºèÔºü {: id="why-inline-mode" }

Âú®ÂâçÂá†Á´†‰∏≠ÔºåÊú∫Âô®‰∫∫Âíå‰∫∫Á±ªÊòØÂêÑËá™Áã¨Á´ã‰∫§ÊµÅÁöÑÔºå‰ΩÜ Telegram Êúâ‰∏ÄÁßçÁâπÊÆäÊ®°ÂºèÔºåÂÖÅËÆ∏Áî®Êà∑Âú®Êú∫Âô®‰∫∫ÁöÑÂ∏ÆÂä©‰∏ã‰ª•Ëá™Â∑±ÁöÑÂêç‰πâÂèëÈÄÅ‰ø°ÊÅØ„ÄÇËøôÂ∞±ÊòØÊâÄË∞ìÁöÑ**ÂÜÖËÅîÊ®°Âºè**Ôºå‰∏ãÈù¢ÊòØÂÆÉÂú®Áé∞ÂÆûÁîüÊ¥ª‰∏≠ÁöÑÊ†∑Â≠êÔºö

![–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ @imdb –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ](images/inline_mode/inline_demo.png)

‰ΩÜËøôÊ†∑ÁöÑÂäüËÉΩÂú®ÂÆûË∑µ‰∏≠Â¶Ç‰ΩïÂ∫îÁî®Âë¢ÔºüÊàëÂª∫ËÆÆÂ§ßÂÆ∂ÁúãÁúã‰∏Ä‰∫õËøë‰πéÂÆòÊñπÁöÑ Telegram Êú∫Âô®‰∫∫ÂêçÁß∞ÔºåÂÆÉ‰ª¨ÈÉΩÊúâÂÜÖËÅîÊ®°ÂºèÔºö

* [@gif](https://t.me/gif) 
* [@wiki](https://t.me/wiki)
* [@imdb](https://t.me/imdb)
* [@youtube](https://t.me/youtube)
* [@foursquare](https://t.me/foursquare)
* [@music](https://t.me/music)
* [@gamee](https://t.me/gamee)
* [@like](https://t.me/like)

ËøôÊ†∑ÁöÑ‰æãÂ≠ê‰∏çËÉúÊûö‰∏æÔºå‰ΩÜÊàëÂ∏åÊúõÂ§ßÂÆ∂ÈÉΩËÉΩÊòéÁôΩÔºöÂÜÖËÅîÊ®°ÂºèÈùûÂ∏∏ÈÄÇÂêàÂú®ÂΩìÂâçËÅäÂ§©‰∏≠ÊèíÂÖ•ÂÜÖÂÆπ„ÄÇTelegram Â∞ÜÊ≠§Á±ªÊú∫Âô®‰∫∫ÁöÑÈÉ®ÂàÜÂäüËÉΩÔºàÂ¶ÇÊäïÁ•®„ÄÅgifÔºâÂ∫îÁî®Âà∞‰∫ÜÂÆòÊñπÂ∫îÁî®‰∏≠Ôºå‰ΩÜÂÖ∂‰ΩôÂäüËÉΩËá≥‰ªä‰ªçÂÆåÂÖ®ÂèØÁî®„ÄÇ

!!! warning "ÈáçË¶Å"

    ÂõûÊÉ≥‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊúâ‰∏Ä‰∏™Â∏¶Êúâ `callback` ÊåâÈíÆÁöÑÈîÆÁõòËøûÊé•Âà∞‰ªéÂÜÖËÅîÊ®°ÂºèÂèëÈÄÅÁöÑÊ∂àÊÅØ‰∏äÔºåÊåâ‰∏ãËØ•ÊåâÈíÆÂêéÔºå
    Êú∫Âô®‰∫∫Â∞ÜÊî∂Âà∞‰∏Ä‰∏™ `CallbackQuery` ÂØπË±°ÔºåÂÖ∂‰∏≠Ê≤°Êúâ `Message` ÂØπË±°„ÄÇÂèñËÄå‰ª£‰πãÁöÑÊòØ‰∏Ä‰∏™ÂæàÂ∞ë‰ΩøÁî®ÁöÑ `inline_message_id` ÂØπË±°„ÄÇ

### Êé•Êî∂ËØ∑Ê±ÇÁöÑÊ†ºÂºè {: id="incoming-update-format" }

ÂΩìÁî®Êà∑Âú®ËÅäÂ§©‰∏≠ÂÜôÂÖ•Êú∫Âô®‰∫∫Áî®Êà∑ÂêçÂπ∂ËæìÂÖ•ÊñáÊú¨Êó∂ÔºåÂ∞±‰ºöÂàõÂª∫‰∏Ä‰∏™ [InlineQuery](https://core.telegram.org/bots/api#inlinequery) Á±ªÂûãÁöÑÊõ¥Êñ∞„ÄÇ
Â¶ÇÊûú‰ªîÁªÜÁ†îÁ©∂Ëøô‰∏™ÂØπË±°ÁöÑÂ≠óÊÆµÔºå‰Ω†ÂèØËÉΩ‰ºöÂèëÁé∞‰∏Ä‰∫õÂ•áÊÄ™ÁöÑÂú∞Êñπ„ÄÇ

È¶ñÂÖàÔºåÊ≤°ÊúâË∞ÉÁî®Êú∫Âô®‰∫∫ÁöÑËÅäÂ§©ÁöÑËÅäÂ§© IDÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØ‰∏Ä‰∏™ÂèØÈÄâÂ≠óÊÆµ `chat_type` ÔºåÊòæÁ§∫ÔºàÂ¶ÇÊûúÈùûÁ©∫ÔºâËÅäÂ§©ÁöÑÁ±ªÂûãÔºàÁßÅ‰∫∫„ÄÅÁæ§ÁªÑ„ÄÅË∂ÖÁ∫ßÁæ§ÁªÑ„ÄÅÈ¢ëÈÅìÔºâ„ÄÇ
ËøôÊ†∑ÂÅöÁöÑÂéüÂõ†ÂæàÁÆÄÂçïÔºöÂõ†‰∏∫Ë¶ÅÂú®ÂÜÖËÅîÊ®°Âºè‰∏ã‰ΩøÁî®Êú∫Âô®‰∫∫ÔºåÊÇ®‰∏çÂøÖÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞‰ªª‰Ωï‰∏úË•ø‰∏äÔºåÊ∑ªÂä†‰∏Ä‰∏™ËÅäÂ§©ÂØπË±°Â∞ÜÂÖÅËÆ∏ÊÇ®Âú®Ë¥≠Áâ©ËΩ¶‰∏≠Ë∞®ÊÖéÂú∞Ë∑üË∏™ÂíåÊî∂ÈõÜËÅäÂ§©„ÄÇ

ÂÖ∂Ê¨°ÔºåÊúâ‰∏Ä‰∏™Â≠óÊÆµ `offset` ‰∏çÊòØÊï∞Â≠óÔºåËÄåÊòØÂ≠óÁ¨¶‰∏≤„ÄÇÈóÆÈ¢òÊòØÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÊú∫Âô®‰∫∫Âú®ÂìçÂ∫îÂÜÖËÅîËØ∑Ê±ÇÊó∂ÂêëÁî®Êà∑ÂèëÈÄÅÁöÑÁªìÊûú‰∏çËÉΩË∂ÖËøá 50 ‰∏™„ÄÇ
Ë¶ÅÊòæÁ§∫Êõ¥Â§öÁªìÊûúÔºåÂøÖÈ°ªÂú®ÂìçÂ∫îÊó∂‰º†ÈÄí `next_offset` ÂèÇÊï∞ÔºåËØ•ÂèÇÊï∞Â∞ÜÂú®‰∏ã‰∏Ä‰∏™ `InlineQuery` ÁöÑ `offset` Â≠óÊÆµ‰∏≠ÈáçÂ§ç„ÄÇ
Âõ†Ê≠§ÔºåÊú∫Âô®‰∫∫‰ºöÊÑèËØÜÂà∞ÔºåÂÆÉÈúÄË¶Å‰ªé `offset` ÂºÄÂßãÂä†ËΩΩÊñ∞Êï∞ÊçÆ„ÄÇ‰πãÊâÄ‰ª•‰ΩøÁî®Â≠óÁ¨¶‰∏≤ÔºåÊòØÂõ†‰∏∫Èô§‰∫ÜÊï∞Â≠óÂ§ñÔºåËøòÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∫õÊ†áËØÜÁ¨¶ÔºåÂ¶Ç `UUID`„ÄÇ

### ÂèëÂá∫Á≠îÂ§çÁöÑÊ†ºÂºè {: id="outgoing-answer-format" }

ÂõûÁ≠îÁî®Êà∑Êü•ËØ¢ÁöÑÊñπÊ≥ïÂè™Êúâ‰∏ÄÁßçÔºö[answerInlineQuery](https://core.telegram.org/bots/api#answerinlinequery)„ÄÇ
‰ΩÜË¶ÅÂèëÈÄÅÁöÑÁ±ªÂûã[Â§öËææ 20 Áßç](https://core.telegram.org/bots/api#inlinequeryresult)„ÄÇ
Êõ¥ÂáÜÁ°ÆÂú∞ËØ¥ÔºåÂÆûÈôÖ‰∏äÊúâ 11 ÁßçÔºåÂõ†‰∏∫ÂÖ∂‰ΩôÁöÑÈÉΩÊòØÁõ∏ÂêåÁöÑÁ±ªÂûãÔºåÂè™ÊòØËæìÂÖ•Êï∞ÊçÆ‰∏çÂêåÔºå‰æãÂ¶ÇÔºåÁî® `file_id` ‰ª£ÊõøÂ™í‰ΩìÊñá‰ª∂ÈìæÊé•„ÄÇ
ÊúÄÂ•Ω‰∏çË¶ÅÊää‰∏çÂêåÁöÑÁ±ªÂûãÊ∑∑Âú®‰∏ÄËµ∑ÔºåÂ∞§ÂÖ∂ÊòØ‰∏çË¶ÅÂíåÂÖ∂‰ªñÁ±ªÂûãÊ∑∑Âú®‰∏ÄËµ∑„ÄÇËÆ©Êàë‰ª¨ÂàÜÂà´ËÄÉËôëÂÖ∂‰∏≠‰∏Ä‰∫õÁ±ªÂûã„ÄÇ

![—Ç–∏–ø InlineQueryResultArticle](images/inline_mode/inline_articles.jpg)

ÊúÄÂ∏∏Áî®ÁöÑÁ±ªÂûãÂèØËÉΩÊòØ [InlineQueryResultArticle](https://core.telegram.org/bots/api#inlinequeryresultarticle)ÔºàÂ¶Ç‰∏äÂõæÔºâ„ÄÇ
Âú®ÊâÄÊúâ‰∏ªË¶ÅÂÆ¢Êà∑Á´Ø‰∏≠ÔºåÂÆÉÁúãËµ∑Êù•ÂÉè‰∏ÄÂè†Áü©ÂΩ¢ÂùóÔºåÊÄªÊòØÊúâ‰∏Ä‰∏™Ê†áÈ¢òÔºåÊúâÊó∂Êúâ‰∏Ä‰∏™ÊèèËø∞ÔºåÂ∑¶ËæπÊúâ‰∏Ä‰∏™È¢ÑËßàÂõæÁâáÊàñÂè™ÊòØ‰∏Ä‰∏™Â≠òÊ†π„ÄÇ
Â¶ÇÊûúÂºÄÂèë‰∫∫ÂëòËÆæÁΩÆ‰∫Ü `url` Â±ûÊÄßÔºå‰∏Ä‰∫õÂÆ¢Êà∑Á´ØÂ∞±‰ºöÂú®ÊèèËø∞Ë°å‰∏ãÊòæÁ§∫ÊåáÂÆöÈìæÊé•ÔºåÈ¢ÑËßàÂõæÂ∞±‰ºöÂèòÊàêÂèØÁÇπÂáªÁöÑÔºåÂπ∂Áõ¥Êé•ÊåáÂêëÊµèËßàÂô®‰∏≠ÁöÑÈìæÊé•Êú¨Ë∫´„ÄÇ
ÁÇπÂáªÂ≠óÁ¨¶‰∏≤‰ºöÂèëÈÄÅ `input_message_content` ÂèÇÊï∞‰∏≠ÊåáÂÆöÁöÑÂÜÖÂÆπÔºàËØ•ÂèÇÊï∞‰∏∫ÂøÖÈÄâÂèÇÊï∞ÔºâÔºåËøô‰∫õÂÜÖÂÆπÊúâ 5 Áßç‰∏çÂêåÁ±ªÂûãÔºö

* ÊñáÊú¨
* Âú∞ÁêÜ‰ΩçÁΩÆ
* Âú∞Ê†á (venue)
* ËÅîÁ≥ª
* ÂèëÁ•® (invoice)

![—Ç–∏–ø InlineQueryResultPhoto](images/inline_mode/inline_pictures.png)

ÂÖ∂‰ªñÁ±ªÂûãÊåáÁöÑÊòØÊâÄË∞ìÁöÑ "Â™í‰ΩìÊñá‰ª∂"ÔºåÊàë‰ª¨Â∞Ü‰ª•ÂõæÁâá‰∏∫‰æãËøõË°åËØ¥Êòé„ÄÇ
ÂìçÂ∫î‰∏ÄÁªÑÂõæÂÉèÊó∂ÔºåÊï∞ÊçÆ‰ºö‰ª•ÂûÇÁõ¥Á£ÅË¥¥ÔºàÂ¶Ç‰∏äÈù¢ÁöÑÊà™ÂõæÔºâÊàñÊªöÂä®Ê∞¥Âπ≥Êù°ÔºàÂ¶Ç iOS ÁâàÊú¨ÔºâÁöÑÊñπÂºèÊéíÂàó„ÄÇ

Â¶ÇÊûúÂÜçÊ¨°ÊâìÂºÄÊúâÂÖ≥ [InlineQueryResult](https://core.telegram.org/bots/api#inlinequeryresult) ÁöÑÈÉ®ÂàÜÔºå
ÊÇ®‰ºöÂèëÁé∞ÁÖßÁâáÔºà‰∏éÂÖ∂‰ªñÁ±ªÂûã‰∏ÄÊ†∑ÔºâÊúâ‰∏§ÁßçÂèò‰ΩìÔºö `InlineQueryResultPhoto` Âíå `InlineQueryResultCachedPhoto` „ÄÇ
‰∏çÂêå‰πãÂ§ÑÂú®‰∫éÔºåÁ¨¨‰∏Ä‰∏™Âèò‰ΩìÊé•ÂèóÊåáÂêëÁΩëÁªúÂõæÁâáÁöÑÈìæÊé•ÔºåËÄåÁ¨¨‰∫å‰∏™Âèò‰ΩìÊé•ÂèóÊù•Ëá™Â∑≤‰∏ä‰º†Ëá≥ Telegram ÁöÑÂ™í‰ΩìÁöÑ `file_id` „ÄÇ

!!! warning "ÈáçË¶Å"

    Âú®ÂÜÖËÅîÊ®°Âºè‰∏ãÔºå‰∏çËÉΩÁõ¥Êé•‰ªéÊñá‰ª∂‰∏ä‰º†ÂõæÁâá„ÄÇË¶Å‰πàÊòØ `URL` ÔºåË¶Å‰πàÊòØ `file_id` „ÄÇÊ≤°ÊúâÁ¨¨‰∏â‰∏™ÈÄâÈ°π„ÄÇ

ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÁÇπÂáªÁªìÊûúÂàóË°®‰∏≠ÁöÑÂ™í‰ΩìÊñá‰ª∂‰ºöÂ∞ÜËØ•Â™í‰ΩìÂèëÈÄÅÂà∞Ë∞ÉÁî®ÁöÑËÅäÂ§©Á™óÂè£„ÄÇ
‰ΩÜÊòØÔºåÂ¶ÇÊûúÊÇ®ÊåáÂÆö‰∫Ü `input_message_content` ÂèÇÊï∞ÔºàÂØπ‰∫éÂ™í‰ΩìÊñá‰ª∂Êù•ËØ¥ÊòØÂèØÈÄâÂèÇÊï∞ÔºâÔºåÈÇ£‰πàÁÇπÂáªÂêéÂ∞ÜÂèëÈÄÅËØ•ÂèÇÊï∞‰∏≠ÊåáÂÆöÁöÑ‰ªª‰ΩïÂÜÖÂÆπ„ÄÇ
‰æãÂ¶ÇÔºåÁÇπÂáª‰∏ÄÈÉ®ÁîµÂΩ±ÁöÑÂ∞ÅÈù¢ÔºåÂ∞±‰ºöÂèëÈÄÅÁîµÂΩ±ÁöÑÊñáÂ≠óËØ¥ÊòéÂíåÂú®Á∫øÂΩ±Èô¢ÁöÑËßÇÁúãÈìæÊé•„ÄÇ
ÊàñËÄÖÔºåÁÇπÂáªÂëòÂ∑•ÁöÑÁÖßÁâáÂ∞Ü‰ª• üëÄ ËÅîÁ≥ª‰∫∫ÁöÑÂΩ¢ÂºèÂèëÈÄÅ‰ªñÁöÑÁîµËØùÂè∑Á†Å„ÄÇ
È°∫‰æøËØ¥‰∏Ä‰∏ãÔºåÂ∞ΩÁÆ°Â™í‰ΩìÊúâ `title` Âíå `description` ÂèÇÊï∞Ôºå‰ΩÜÂÆ¢Êà∑Á´Ø‰∏ç‰ºöÊòæÁ§∫ÂÆÉ‰ª¨ÔºåËÄå Bot API Êú¨Ë∫´‰πü‰ºöÂøΩÁï•ÂÆÉ‰ª¨„ÄÇ

answerInlineQuery ÊñπÊ≥ïÊúâÂá†‰∏™ÂèÇÊï∞ÈúÄË¶ÅÊàë‰ª¨Ê≥®ÊÑè„ÄÇ
È¶ñÂÖàÊòØ `cache_time` „ÄÇÂÆÉÂÜ≥ÂÆö‰∫ÜÊü•ËØ¢ÁªìÊûúÂèØ‰ª•Ë¢´Ë¥≠Áâ©ËΩ¶ÊúçÂä°Âô®ÁºìÂ≠òÂ§öÈïøÊó∂Èó¥Ôºå‰ª•ÈÅøÂÖçÂèëÈÄÅÁªôÊú∫Âô®‰∫∫„ÄÇ
Â¶ÇÊûúÊÇ®ÁöÑÊï∞ÊçÆÊòØÈùôÊÄÅÁöÑÊàñÂæàÂ∞ëÂèòÂåñÔºåÂèØ‰ª•ÈöèÊÑèÂ¢ûÂä†ËØ•ÂÄº„ÄÇ
ÂÖ∂Ê¨°Ôºå `is_personal` Ê†áÂøóÔºåÂÆÉÂ∞ÜÂΩ±ÂìçÊü•ËØ¢ÁªìÊûúÊòØÂè™ÁºìÂ≠ò‰∏Ä‰∏™Áî®Êà∑ËøòÊòØÂêåÊó∂ÁºìÂ≠òÊâÄÊúâÁî®Êà∑„ÄÇ
Â¶ÇÊûúÊÇ®ÁöÑÊú∫Âô®‰∫∫Ê†πÊçÆÁî®Êà∑ ID ÊòæÁ§∫‰∏™ÊÄßÂåñÂÄºÔºåËØ∑Â∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ `True`„ÄÇ

!!! info ""

    ËøôÂá†Ë°åÁöÑ‰ΩúËÄÖÊúâ‰∏ÄÊ¨°ÂøòËÆ∞Âú®‰ªñÁöÑÊú∫Âô®‰∫∫ @my_id_bot ‰∏≠ÊåáÂÆö `is_personal` Ê†áÂøóÔºåÂ∞ÜÁºìÂ≠òËÆæÁΩÆ‰∏∫ 86400 ÁßíÔºà1 Â§©ÔºâÔºå
    ÁªìÊûúÂê¨Âà∞Áî®Êà∑ÊÑ§ÊÑ§‰∏çÂπ≥Âú∞ÂèëÈÄÅ‰ªñÁöÑ ID ËÄå‰∏çÊòØËá™Â∑±ÁöÑ ID„ÄÇ‰ªéÂà´‰∫∫ÁöÑÈîôËØØ‰∏≠Â≠¶‰π†ÔºåËÄå‰∏çÊòØ‰ªéËá™Â∑±ÁöÑÈîôËØØ‰∏≠Â≠¶‰π†„ÄÇ

Á¨¨‰∏âÔºåÂ≠óÁ¨¶‰∏≤ÂèÇÊï∞ `next_offset` ÂèØ‰ª•ËÆ©ÊÇ®Âú®ÊªöÂä®Êó∂Âä†ËΩΩÁªìÊûúÔºåÂõ†‰∏∫Âú® `InlineQuery` ÁöÑ‰∏Ä‰∏™ÂìçÂ∫î‰∏≠ËøîÂõûÁöÑÂÄº‰∏çËÉΩË∂ÖËøá 50 ‰∏™„ÄÇ
Êàë‰ª¨Â∞ÜÂú®Âè¶‰∏Ä‰∏™Á§∫‰æã‰∏≠ËÄÉËôë `next_offset` ÁöÑ‰ΩøÁî®„ÄÇ

Á¨¨ÂõõÔºå `switch_pm_text` Âíå `switch_pm_parameter` „ÄÇ
Èô§‰∫ÜÊü•ËØ¢ÁªìÊûúÂ§ñÔºåÊú∫Âô®‰∫∫ËøòÂèØ‰ª•ÊòæÁ§∫‰∏Ä‰∏™Â∞èÊåâÈíÆÔºåÊåâÈíÆ‰∏äÊñπÊòæÁ§∫ÂèÇÊï∞ `switch_pm_text` ÁöÑÊñáÊú¨Ôºå
ÁÇπÂáªËØ•ÊåâÈíÆÁ±ª‰ºº‰∫é `deeplink`ÔºåÂç≥Áî®Êà∑Â∞ÜËøõÂÖ•‰∏éÊú∫Âô®‰∫∫ÁöÑÁßÅ‰∫∫ÂØπËØùÔºåÊåâÈíÆ‰∏äÊòæÁ§∫ÁöÑ‰∏çÊòØËæìÂÖ•Ê°ÜÔºå
ËÄåÊòØ‰∏Ä‰∏™ "`ÂºÄÂßã`" ÊåâÈíÆÔºåÁÇπÂáªÂêéÊú∫Âô®‰∫∫Â∞ÜÊî∂Âà∞‰∏ÄÊù°ÊñáÊú¨‰∏∫ `/start –¢–ï–ö–°–¢` ÁöÑÊ∂àÊÅØÔºåÂÖ∂‰∏≠ÁöÑÊñáÊú¨‰∏çÊòØ `TEXT`ÔºåËÄåÊòØÂèÇÊï∞ `switch_pm_parameter` ÁöÑÂÄº„ÄÇ

![–ö–Ω–æ–ø–∫–∞ switch_pm](images/inline_mode/switch_pm_button.png)

Â¶ÇÊûúÊüê‰∏™Êü•ËØ¢Ê≤°ÊúâÁªìÊûúÔºåÊàñËÄÖÊÇ®ÊÉ≥ËÆ©Áî®Êà∑ÊúâÊú∫‰ºöÂø´ÈÄüÊ∑ªÂä†ÂÜÖÂÆπÔºå‰ΩøÁî®ËØ•ÂäüËÉΩÈùûÂ∏∏Êñπ‰æø„ÄÇËøòÊúâ‰∏Ä‰∏™ÂäüËÉΩÔºåÊàë‰ª¨Â∞ÜÂú®Á®çÂêéÁöÑÊú∫Âô®‰∫∫ÂºÄÂèëËøáÁ®ã‰∏≠ËÄÉËôë„ÄÇËØ¥Âà∞ÂÆÉ...

## ÂÆûË∑µ {: id="practice" }

Ë¶ÅËÆ©Êú∫Âô®‰∫∫Áü•ÈÅìÂú®ÂÜÖËÅîÊ®°Âºè‰∏ãË∞ÉÁî®Êó∂Ë¶ÅÊòæÁ§∫‰ªÄ‰πàÔºåÂÆÉÈúÄË¶Å‰∏Ä‰∫õÊï∞ÊçÆÔºö‰∫ãÂÖàÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÊàñ‰ªéÁî®Êà∑Â§ÑÊé•Êî∂ÁöÑÊï∞ÊçÆ„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºåËÆ©Êàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™Êú∫Âô®‰∫∫ÔºåÂÆÉÂ∞Ü‰ªéÁî®Êà∑ÈÇ£ÈáåÊé•Êî∂ÈìæÊé•ÂíåÂõæÁâáÔºåÁÑ∂ÂêéÊ†πÊçÆËØ∑Ê±ÇÂú®ÂÜÖËÅîÊ®°Âºè‰∏ãÊòæÁ§∫ÊâÄÊúâËøô‰∫õÂÜÖÂÆπ„ÄÇ

!!! info ""

    Âà´Âøò‰∫ÜÈÄöËøá [@BotFather](https://t.me/botfather) ÂêØÁî®Êú∫Âô®‰∫∫ÁöÑÂÜÖËÅîÊ®°ÂºèÔºö
    Bot Settings -> Inline Mode -> Turn on

### Â≠òÂÇ®Á≥ªÁªü {: id="storage" }

Áî±‰∫éÊú¨Á´†Â∑≤ÁªèÂæàÈïø‰∫ÜÔºå‰∏∫‰∫ÜÈÅøÂÖçËøáÂ§öÊ∂âÂèäÁªÜËäÇÔºåÊàë‰ª¨ÂêåÊÑèÊµãËØïÊú∫Âô®‰∫∫Â∞Ü‰ΩøÁî®ÊôÆÈÄöÁöÑÂÜÖÂ≠òÂ≠óÂÖ∏‰Ωú‰∏∫Ê®°ÊãüÊï∞ÊçÆÂ∫ì„ÄÇËøôÊ†∑Â∞±‰∏çÁî®ÊãÖÂøÉÂú®Ë∞ÉËØïËøáÁ®ã‰∏≠ÈáçÁΩÆÁä∂ÊÄÅÁöÑÈóÆÈ¢òÔºåÂêåÊó∂‰πüÁÆÄÂåñ‰∫Ü‰∫ãÂÖàÂ°´ÂÖÖÂ≠òÂÇ®Á©∫Èó¥ÁöÑËøáÁ®ãÔºåÂ¶ÇÊûú‰Ω†Á™ÅÁÑ∂ÊÉ≥Áî®Áé∞ÊàêÁöÑÈìæÊé•ÊàñÂõæÁâáËøêË°åÊú∫Âô®‰∫∫ÁöÑËØù„ÄÇ‰∏§ÁßçÊï∞ÊçÆÁ±ªÂûãÂêÑÊúâ‰∏â‰∏™ÂáΩÊï∞ÔºöÊ∑ªÂä†Êï∞ÊçÆ„ÄÅËé∑ÂèñÊï∞ÊçÆ„ÄÅÂà†Èô§Êï∞ÊçÆ„ÄÇ‰ª•‰∏ãÊòØËØ•Êñá‰ª∂ÁöÑÂÖ®ÈÉ®‰ª£Á†ÅÔºö

```python title="storage.py"
from typing import Optional

# –í —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –°–£–ë–î.
# –ù–æ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞ –Ω–∞–º –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –æ–±—ã—á–Ω–æ–º —Å–ª–æ–≤–∞—Ä–µ.
# –£—á—Ç–∏—Ç–µ, —á—Ç–æ –æ–Ω —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞.
data = dict()


def add_link(
        telegram_id: int,
        link: str,
        title: str,
        description: Optional[str]
):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Å—ã–ª–∫—É –≤ —Å–ª–æ–≤–∞—Ä—å

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :param link: —Ç–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏
    :param title: –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Å—ã–ª–∫–∏
    :param description: (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏
    """
    data.setdefault(telegram_id, dict())
    data[telegram_id].setdefault("links", dict())
    data[telegram_id]["links"][link] = {
        "title": title,
        "description": description
    }

def add_photo(
        telegram_id: int,
        photo_file_id: str,
        photo_unique_id: str
):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å–ª–æ–≤–∞—Ä—å

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :param photo_file_id: file_id –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    :param photo_unique_id: file_unique_id –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    """
    data.setdefault(telegram_id, dict())
    data[telegram_id].setdefault("images", [])
    if photo_file_id not in data[telegram_id]["images"]:
        data[telegram_id]["images"].append((photo_file_id, photo_unique_id))

def get_links_by_id(telegram_id: int) -> dict:
    """
    –ü–æ–ª—É—á–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :return: –µ—Å–ª–∏ –ø–æ —é–∑–µ—Ä—É –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ, —Ç–æ —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å—Å—ã–ª–∫–∞–º–∏
    """
    if telegram_id in data and "links" in data[telegram_id]:
        return data[telegram_id]["links"]
    return dict()

def get_images_by_id(telegram_id: int) -> list[str]:
    """
    –ü–æ–ª—É—á–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :return:
    """
    if telegram_id in data and "images" in data[telegram_id]:
        return [item[0] for item in data[telegram_id]["images"]]
    return []

def delete_link(telegram_id: int, link: str):
    """
    –£–¥–∞–ª—è–µ—Ç —Å—Å—ã–ª–∫—É

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :param link: —Å—Å—ã–ª–∫–∞
    """
    if telegram_id in data:
        if "links" in data[telegram_id]:
            if link in data[telegram_id]["links"]:
                del data[telegram_id]["links"][link]

def delete_image(telegram_id: int, photo_file_unique_id: str):
    """
    –£–¥–∞–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

    :param telegram_id: ID —é–∑–µ—Ä–∞ –≤ Telegram
    :param photo_file_unique_id: file_unique_id –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    """
    if telegram_id in data and "images" in data[telegram_id]:
        for index, (_, unique_id) in enumerate(data[telegram_id]["images"]):
            if unique_id == photo_file_unique_id:
                data[telegram_id]["images"].pop(index)
```

### Êú∫Âô®‰∫∫‰∏≠ÁöÑÂëΩ‰ª§ {: id="common-commands" }

Êú∫Âô®‰∫∫ÊúâÂá†Êù°Â∏∏Áî®ÂëΩ‰ª§Ôºö `/start` „ÄÅ `/help` „ÄÅ `/save` „ÄÅ `/delete` Âíå `/cancel` „ÄÇ
Ââç‰∏§‰∏™ÊòØ‰ø°ÊÅØÊÄßÁöÑÔºå `/save` ÂêØÂä®‰øùÂ≠òÊï∞ÊçÆÁöÑËøõÁ®ãÔºå `/delete` ÂêØÂä®Âà†Èô§Êï∞ÊçÆÁöÑËøõÁ®ãÔºå `/cancel` ÂàÜÂà´‰∏≠Êñ≠‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑËøõÁ®ã„ÄÇ
ËÆ©Êàë‰ª¨‰ªé `/save` ÂëΩ‰ª§ÂºÄÂßã„ÄÇ

### ‰øùÂ≠òÊï∞ÊçÆ {: id="data-saving" }

Ëøô‰∏ÄÊ¨°ÔºåÊàë‰ª¨Â∞ÜÂú®‰∏Ä‰∏™ÂçïÁã¨ÁöÑÊñá‰ª∂‰∏≠ÊèèËø∞Áä∂ÊÄÅÔºå‰ª•‰æø‰∫éÂØºÂÖ•„ÄÇ
‰∏∫Ê≠§ÔºåÊàë‰ª¨Â∞ÜÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂ `states.py` Âπ∂ÂÆûÁé∞‰∏Ä‰∏™Á±ª `SaveCommon` ÔºåÂÖ∂‰∏≠Â∞ÜÊúâ‰∏Ä‰∏™Áä∂ÊÄÅ "`Á≠âÂæÖËæìÂÖ•`"Ôºö

```python title="states.py"
from aiogram.fsm.state import StatesGroup, State

class SaveCommon(StatesGroup):
    waiting_for_save_start = State()
```

Áé∞Âú®ÔºåËÆ©Êàë‰ª¨Êù•Â§ÑÁêÜ‰∏çÂêåÁ±ªÂûã‰ø°ÊÅØÁöÑ‰øùÂ≠òÈóÆÈ¢ò

#### ‰øùÂ≠òÊñáÊú¨ {: id="save-text" }

ËÆ©Êàë‰ª¨‰ªéÊñáÊú¨‰ø°ÊÅØÂºÄÂßã„ÄÇÊÉ≥Ê≥ïÂæàÁÆÄÂçïÔºöÁî®Êà∑ÂèëÈÄÅ‰∏ÄÊù°‰ø°ÊÅØ„ÄÇÂ¶ÇÊûúËá≥Â∞ëÊúâ‰∏Ä‰∏™ÈìæÊé•ÔºåÂ∞±‰ºöÊèêÂèñÂá∫Êù•ÔºåÁÑ∂ÂêéÊèêÁ§∫Áî®Êà∑ËæìÂÖ•ÈìæÊé•ÂêçÁß∞ÔºàÂøÖÂ°´ÔºâÂíåÊèèËø∞„ÄÇÊúÄÂêé‰∏ÄÊ≠•ÂèØ‰ª•Áî® `/skip` Ë∑≥Ëøá„ÄÇÂ¶ÇÊûúÊúâÂ§ö‰∏™ÈìæÊé•ÔºåÂàôÂè™ÊèêÂèñÁ¨¨‰∏Ä‰∏™ÈìæÊé•„ÄÇ

Èô§‰∫Ü‰∏äËø∞ÁöÑ "`Á≠âÂæÖËæìÂÖ•`" Áä∂ÊÄÅÂ§ñÔºåËøòÂ∞ÜÊúâ‰∏§‰∏™ÁâπÂÆö‰∫éÊñáÊú¨ÁöÑÁä∂ÊÄÅÔºö"`Á≠âÂæÖÊ†áÈ¢òËæìÂÖ•`" Âíå "`Á≠âÂæÖÊèèËø∞ËæìÂÖ•`"„ÄÇÂú® `states.py` ‰∏≠ÔºåÊàë‰ª¨Â∞ÜÊ∑ªÂä†Ëøô‰∫õÁä∂ÊÄÅÔºö

```python title="states.py"
# —Ç—É—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥

class TextSave(StatesGroup):
    waiting_for_title = State()
    waiting_for_description = State()
```

ËÆ©Êàë‰ª¨‰ªé `SaveCommon` -> `waiting_for_save_start` Áä∂ÊÄÅ‰∏ãÁöÑÊØè‰∏™ÊñáÊú¨ÁöÑ‰∏§‰∏™Â§ÑÁêÜÁ®ãÂ∫èÂºÄÂßã„ÄÇ
Êàë‰ª¨ÈúÄË¶ÅÊçïÊçâÂ∏¶ÊúâÈìæÊé•ÁöÑ‰ø°ÊÅØ„ÄÇÂú®ÊúâÂÖ≥ [ËøáÊª§Âô®Âíå‰∏≠Èó¥‰ª∂](filters-and-middlewares.md#filters-as-classes) ÁöÑÁ´†ËäÇ‰∏≠ÔºåÊàë‰ª¨Â∑≤ÁªèÂÅö‰∫Ü‰∏Ä‰∏™Á±ª‰ººÁöÑËøáÊª§Âô®Ôºå‰ΩÜÈíàÂØπÁöÑÊòØÁî®Êà∑Âêç„ÄÇ
Áé∞Âú®ÔºåÊàë‰ª¨Ë¶ÅÂ§çÂà∂ËØ•ËøáÊª§Âô®ÔºåÂπ∂Â∞ÜÂÖ∂Áî®‰∫éÈìæÊé•Ôºö

```python title="filters/text_has_link.py"
from typing import Union, Dict, Any

from aiogram.filters import BaseFilter
from aiogram.types import Message


class HasLinkFilter(BaseFilter):
    async def __call__(self, message: Message) -> Union[bool, Dict[str, Any]]:
        # –ï—Å–ª–∏ entities –≤–æ–æ–±—â–µ –Ω–µ—Ç, –≤–µ—Ä–Ω—ë—Ç—Å—è None,
        # –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —ç—Ç–æ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
        entities = message.entities or []

        # –ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å—Å—ã–ª–∫–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ—ë
        for entity in entities:
            if entity.type == "url":
                return {"link": entity.extract_from(message.text)}

        # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
        return False
```

‰∏∫‰∫ÜÁº©Áü≠ÂØºÂÖ•Êó∂Èó¥ÔºåËÆ©Êàë‰ª¨ÁºñËæëÊñá‰ª∂ `filters/__init__.py` Ôºö

```python title="filters/__init__.py"
from .text_has_link import HasLinkFilter

# –î–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –∑–∞—Ç–µ–º –ø—Ä–æ—Å—Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
# from filters import HasLinkFilter
__all__ = [
    "HasLinkFilter"
]
```

‰∏∫‰ªÄ‰πàÊØè‰∏™ÊñáÊú¨ÈúÄË¶Å‰∏§‰∏™Â§ÑÁêÜÁ®ãÂ∫èÔºüÁ¨¨‰∏Ä‰∏™Â§ÑÁêÜÁ®ãÂ∫èÂ∞ÜÊçïÊçâÊúâÈìæÊé•ÁöÑ‰ø°ÊÅØÔºåÁ¨¨‰∫å‰∏™Â§ÑÁêÜÁ®ãÂ∫èÂ∞ÜÊçïÊçâÊ≤°ÊúâÈìæÊé•ÁöÑ‰ø°ÊÅØ„ÄÇÂÜô‰ΩúÔºö

```python title="handlers/save_text.py"
# <–∏–º–ø–æ—Ä—Ç—ã>

@router.message(SaveCommon.waiting_for_save_start, F.text, HasLinkFilter())
async def save_text_has_link(message: Message, link: str, state: FSMContext):
    await state.update_data(link=link)
    await state.set_state(TextSave.waiting_for_title)
    await message.answer(
        text=f"–û–∫–µ–π, —è –Ω–∞—à—ë–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å—Å—ã–ª–∫—É {link}. "
             f"–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å –º–Ω–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–Ω–µ –±–æ–ª—å—à–µ 30 —Å–∏–º–≤–æ–ª–æ–≤)"
    )

@router.message(SaveCommon.waiting_for_save_start, F.text)
async def save_text_no_link(message: Message):
    await message.answer(
        text="–≠–º–º.. —è –Ω–µ –Ω–∞—à—ë–ª –≤ —Ç–≤–æ—ë–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å—Å—ã–ª–∫—É. "
             "–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –Ω–∞–∂–º–∏ /cancel, —á—Ç–æ–±—ã –æ—Ç–º–µ–Ω–∏—Ç—å."
    )
```

Êé•‰∏ãÊù•ÔºåÂ∏åÊúõÁî®Êà∑ËæìÂÖ•ËÆ∞ÂΩïÊ†áÈ¢ò„ÄÇÂú®ËøôÈáåÔºåÊàë‰ª¨‰πüÂèØ‰ª•Â∞ÜÈÄªËæëÂàÜÊàê‰∏§‰∏™Â§ÑÁêÜÁ®ãÂ∫èÔºöÊàêÂäüÂíå‰∏çÂπ∏ÊÉÖÂÜµ‰∏ãÁöÑÂ∑ßÂêàÔºö

```python title="handlers/save_text.py" hl_lines="3"
# –∏–º–ø–æ—Ä—Ç—ã –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —à–∞–≥–∏

@router.message(TextSave.waiting_for_title, F.text.func(len) <= 30)
async def title_entered_ok(message: Message, state: FSMContext):
    await state.update_data(title=message.text, description=None)
    await state.set_state(TextSave.waiting_for_description)
    await message.answer(
        text="–¢–∞–∫, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∂—É. –¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏ –æ–ø–∏—Å–∞–Ω–∏–µ "
             "(—Ç–æ–∂–µ –Ω–µ –±–æ–ª—å—à–µ 30 —Å–∏–º–≤–æ–ª–æ–≤) "
             "–∏–ª–∏ –Ω–∞–∂–º–∏ /skip, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —à–∞–≥"
    )

@router.message(TextSave.waiting_for_title, F.text)
async def too_long_title(message: Message):
    await message.answer("–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑")
    return
```

ËØ∑Ê≥®ÊÑè‰ª£Á†Å `F.text.func(len) <= 30` „ÄÇ
È≠îÊúØËøáÊª§Âô®ÂÖÅËÆ∏ÊÇ®ÂêëËæìÂÖ•‰º†ÈÄí‰∏Ä‰∫õÂáΩÊï∞ÔºåËøô‰∫õÂáΩÊï∞Â∞ÜÂú® `.func` ‰πãÂâçÊåáÂÆöÁöÑ‰ªª‰ΩïÂÜÖÂÆπ‰∏äÊâßË°å„ÄÇ
‰æãÂ¶ÇÔºå `F.text.func(len) -> len(F.text)` ÔºåÂπ∂‰∏îÂè™ÊúâÂΩì `.text` Â±ûÊÄß‰∏çÊòØ `None` Êó∂Êâç‰ºöÊâßË°åÔºàÊç¢Âè•ËØùËØ¥ÔºåËøôÈáåËøòÊúâ‰∏Ä‰∏™ÂÜÖÂÆπÊèêÁ§∫Ê£ÄÊü•Ôºâ„ÄÇ
‰ΩÜÊÄªÁöÑÊù•ËØ¥ÔºåÂú® [magic-filter](https://github.com/aiogram/magic-filter/blob/3c5e38fd5cd359fd961e26bab17e65201b02c1c6/magic_filter/magic.py#L227-L228) ‰∏≠ÊîØÊåÅ `len() Ôºö F.text.len() <= 30` „ÄÇ

Êé•‰∏ãÊù•ÊòØÊèèËø∞ÁöÑÂ§ÑÁêÜÁ®ãÂ∫è„ÄÇÂú®ËøôÈáåÔºåÊàë‰ª¨ÂèØ‰ª•ÂÜçÊ¨°Â∞ÜÂÖ∂ÂàÜ‰∏∫‰∏§‰∏™Â§ÑÁêÜÁ®ãÂ∫è....„ÄÇÁ≠âÁ≠âÔºå‰ΩÜÊòØ `too_long_title()` ÂáΩÊï∞‰πüÂèØ‰ª•Áî®‰∫éÊèèËø∞Ê≠•È™§ÔºåÂõ†‰∏∫Êàë‰ª¨ÊúâÁõ∏ÂêåÁöÑÊñáÊú¨ÈôêÂà∂ÔºÅËÆ©Êàë‰ª¨ÈáçÊñ∞ÂëΩÂêçÂÆÉÔºåÂπ∂Âú®Âè¶‰∏Ä‰∏™Ê≠•È™§‰∏≠Ê∑ªÂä†‰∏Ä‰∏™ËøáÊª§Âô®Ôºö

```python title="handlers/save_text.py"
@router.message(TextSave.waiting_for_title, F.text)
@router.message(TextSave.waiting_for_description, F.text)
async def text_too_long(message: Message):  # –±—ã–≤—à. too_long_title()
    await message.answer("–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑")
    return
```

Áé∞Âú®ËÆ©Êàë‰ª¨Êù•ÁúãÁúãÊúÄÂêé‰∏Ä‰∏™Â§ÑÁêÜÁ®ãÂ∫èÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËæìÂÖ•ÁÆÄÁü≠ÊèèËø∞Êàñ `/skip` ÂëΩ‰ª§Êù•Â§ÑÁêÜÂÆÉ„ÄÇÂõ†‰∏∫Êàë‰ª¨ÈúÄË¶ÅÊçïÊçâ‰∏§‰∏™ËæìÂÖ•ÔºåÊâÄ‰ª•Ë¶ÅÊåÇËµ∑‰∏§‰∏™Ë£ÖÈ•∞Âô®ÔºåÂú®ÂèÇÊï∞‰∏≠Êé•ÂèóÂèØÈÄâÁöÑ `CommandObject` Âπ∂Êü•ÁúãÂÜÖÈÉ®ÔºöÂ¶ÇÊûúÊ≤°ÊúâÂëΩ‰ª§ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ËæìÂÖ•‰∫Ü‰∏Ä‰∏™ÊèèËø∞Ôºö

```python title="handlers/save_text.py"
# –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ü–ï–†–ï–î text_too_long() !
@router.message(TextSave.waiting_for_description, F.text.func(len) <= 30)
@router.message(TextSave.waiting_for_description, Command("skip"))
async def last_step(
        message: Message,
        state: FSMContext,
        command: Optional[CommandObject] = None
):
    if not command:
        await state.update_data(description=message.text)
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—à—É –Ω–µ–Ω–∞—Å—Ç–æ—è—â—É—é –ë–î
    data = await state.get_data()
    add_link(message.from_user.id, data["link"], data["title"], data["description"])

    await message.answer("–°—Å—ã–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!")
    await state.clear()
```

Âõ†Ê≠§ÔºåÊàë‰ª¨Âà∂‰Ωú‰∫Ü‰∏ÄÁªÑÂ§ÑÁêÜÁ®ãÂ∫èÔºåÁî®‰∫é‰øùÂ≠òÂØπÂÜÖÂ≠òÊï∞ÊçÆÂ∫ìÁöÑÂºïÁî®„ÄÇ‰∏ãÈù¢ÊòØÊï¥‰∏™Êñá‰ª∂ÁöÑ‰ª£Á†ÅÔºö

```python title="handlers/save_text.py"
from typing import Optional

from aiogram import Router, F
from aiogram.filters.command import Command, CommandObject
from aiogram.fsm.context import FSMContext
from aiogram.types import Message, InlineKeyboardMarkup, InlineKeyboardButton

from filters import HasLinkFilter
from states import SaveCommon, TextSave
from storage import add_link

router = Router()

@router.message(SaveCommon.waiting_for_save_start, F.text, HasLinkFilter())
async def save_text_has_link(message: Message, link: str, state: FSMContext):
    await state.update_data(link=link)
    await state.set_state(TextSave.waiting_for_title)
    await message.answer(
        text=f"–û–∫–µ–π, —è –Ω–∞—à—ë–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å—Å—ã–ª–∫—É {link}. "
             f"–¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å –º–Ω–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ –±–æ–ª—å—à–µ 30 —Å–∏–º–≤–æ–ª–æ–≤)"
    )

@router.message(SaveCommon.waiting_for_save_start, F.text)
async def save_text_no_link(message: Message):
    await message.answer(
        text="–≠–º–º.. —è –Ω–µ –Ω–∞—à—ë–ª –≤ —Ç–≤–æ—ë–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å—Å—ã–ª–∫—É. "
             "–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –Ω–∞–∂–º–∏ /cancel, —á—Ç–æ–±—ã –æ—Ç–º–µ–Ω–∏—Ç—å."
    )

@router.message(TextSave.waiting_for_title, F.text.func(len) <= 30)
async def title_entered_ok(message: Message, state: FSMContext):
    await state.update_data(title=message.text, description=None)
    await state.set_state(TextSave.waiting_for_description)
    await message.answer(
        text="–¢–∞–∫, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∂—É. –¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏ –æ–ø–∏—Å–∞–Ω–∏–µ "
             "(—Ç–æ–∂–µ –Ω–µ –±–æ–ª—å—à–µ 30 —Å–∏–º–≤–æ–ª–æ–≤) "
             "–∏–ª–∏ –Ω–∞–∂–º–∏ /skip, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —à–∞–≥"
    )

@router.message(TextSave.waiting_for_description, F.text.func(len) <= 30)
@router.message(TextSave.waiting_for_description, Command("skip"))
async def last_step(
        message: Message,
        state: FSMContext,
        command: Optional[CommandObject] = None
):
    if not command:
        await state.update_data(description=message.text)
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—à—É –Ω–µ–Ω–∞—Å—Ç–æ—è—â—É—é –ë–î
    data = await state.get_data()
    add_link(message.from_user.id, data["link"], data["title"], data["description"])
    await state.clear()
    kb = [[InlineKeyboardButton(
        text="–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å",
        switch_inline_query="links"
    )]]
    await message.answer(
        text="–°—Å—ã–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=kb)
    )

@router.message(TextSave.waiting_for_title, F.text)
@router.message(TextSave.waiting_for_description, F.text)
async def text_too_long(message: Message):
    await message.answer("–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑")
    return
```

#### ‰øùÂ≠òÂõæÁâá {: id="save-images" }

ÂõæÁâáÂ∞±ÁÆÄÂçïÂ§ö‰∫ÜÔºõÂè™ÈúÄ‰∏ÄÊ≠•Âç≥ÂèØÊ∑ªÂä†„ÄÇ‰ΩÜÊúâ‰∏Ä‰∏™ÁªÜÂæÆÂ∑ÆÂà´ÔºöÈô§‰∫ÜÁî®‰∫éÁ®çÂêéÊòæÁ§∫ÁöÑ `file_id` Â§ñÔºå
Êàë‰ª¨ËøòÈúÄË¶Å‰øùÂ≠ò `file_unique_id` ÔºåÂõ†‰∏∫ÂΩìÊàë‰ª¨ÂÖÅËÆ∏Áî®Êà∑Âà†Èô§Â∑≤‰øùÂ≠òÁöÑÂõæÁâáÊó∂ÔºåÂÆÉÂ∞±‰ºöÊ¥æ‰∏äÁî®Âú∫Ôºö

```python title="handlers/save_images.py"
from aiogram import Router, F
from aiogram.fsm.context import FSMContext
from aiogram.types import Message, PhotoSize
from states import SaveCommon
from storage import add_photo

router = Router()

@router.message(SaveCommon.waiting_for_save_start, F.photo[-1].as_("photo"))
async def save_image(message: Message, photo: PhotoSize, state: FSMContext):
    add_photo(message.from_user.id, photo.file_id, photo.file_unique_id)
    await message.answer("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!")
    await state.clear()
```

### ÊòæÁ§∫Êï∞ÊçÆ {: id="show-data" }

Â•Ω‰∫ÜÔºåÊàë‰ª¨Â∑≤ÁªèÂ≠¶‰ºö‰∫ÜÂ¶Ç‰Ωï‰øùÂ≠òÊï∞ÊçÆÔºåÁé∞Âú®ÈúÄË¶Å‰ª•ÊüêÁßçÊñπÂºèÊòæÁ§∫Êï∞ÊçÆ„ÄÇ
‰∏∫Ê≠§ÔºåÊú∫Âô®‰∫∫Â∫îÊçïÊçâ `inline_query` Á±ªÂûãÁöÑÊõ¥Êñ∞ÔºåÂ§ÑÁêÜÁ®ãÂ∫èÂ∞ÜÊé•Êî∂ [InlineQuery](https://core.telegram.org/bots/api#inlinequery) Á±ªÂûãÁöÑÂØπË±°„ÄÇ
Êàë‰ª¨‰∏ç‰ºöÂú®Á©∫Êü•ËØ¢‰∏≠ÊòæÁ§∫‰ªª‰ΩïÂÜÖÂÆπÔºàÊöÇÊó∂ÔºâÔºåÊàë‰ª¨Â∞ÜÂú® `@bot links` Êü•ËØ¢‰∏≠ÊòæÁ§∫ÈìæÊé•ÂàóË°®ÔºåÂú® `@bot images` Êü•ËØ¢‰∏≠ÊòæÁ§∫ÂõæÁâá„ÄÇ
ÂΩìÁÑ∂Ôºå `@bot` Â∞ÜÊòæÁ§∫Êú∫Âô®‰∫∫ÁöÑÁî®Êà∑Âêç„ÄÇ

#### ÊòæÁ§∫ÊñáÊú¨ {: id="show-text" }

Ë¶ÅÂìçÂ∫îÊñáÊú¨‰ø°ÊÅØÔºåÊàë‰ª¨ÈúÄË¶ÅÊî∂ÈõÜ‰∏Ä‰∏™ÂØπË±°ÂàóË°®ÔºåÂÖ∂Á±ªÂûã‰∏∫ [InlineQueryResultArticle](https://core.telegram.org/bots/api#inlinequeryresultarticle) „ÄÇÊàë‰ª¨Â∑≤ÁªèÊã•Êúâ‰∫ÜÊâÄÊúâÂøÖË¶ÅÁöÑÔºàÁîöËá≥ÊòØÈ¢ùÂ§ñÁöÑÔºâÊï∞ÊçÆÔºö

![–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–∞ InlineQueryResultArticle](images/inline_mode/article_content.png "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±—ä–µ–∫—Ç–∞ InlineQueryResultArticle")

ÂØπ‰∫é `input_message_content` ÂèÇÊï∞ÔºåËÆ©Êàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂµåÂ•óÂáΩÊï∞ÔºåÊ†πÊçÆÊúâÊó†ÊèèËø∞ËøîÂõûÊñáÊú¨Ôºö

```python
def get_message_text(
        link: str,
        title: str,
        description: Optional[str]
) -> str:
    text_parts = [f'{html.bold(html.quote(title))}']
    if description:
        text_parts.append(html.quote(description))
    text_parts.append("")  # –¥–æ–±–∞–≤–∏–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
    text_parts.append(link)
    return "\n".join(text_parts)
```

Áé∞Âú®ËÆ©Êàë‰ª¨Êù•ÊèèËø∞‰∏Ä‰∏ãÂ§ÑÁêÜÁ®ãÂ∫èÊú¨Ë∫´Ôºö

```python title="handlers/inline_mode.py"
@router.inline_query(F.query == "links")
async def show_user_links(inline_query: InlineQuery):

    # –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Å—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç
    # –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ
    def get_message_text():
        # —ç—Ç–∞ –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∞ –≤—ã—à–µ ‚Üë

    results = []
    for link, link_data in get_links_by_id(inline_query.from_user.id).items():
        # –í –∏—Ç–æ–≥–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –∑–∞–ø–∏—Ö–∏–≤–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
        results.append(InlineQueryResultArticle(
            id=link,  # —Å—Å—ã–ª–∫–∏ —É –Ω–∞—Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ, –ø–æ—Ç–æ–º—É –ø—Ä–æ–±–ª–µ–º –Ω–µ –±—É–¥–µ—Ç
            title=link_data["title"],
            description=link_data["description"],
            input_message_content=InputTextMessageContent(
                message_text=get_message_text(
                    link=link,
                    title=link_data["title"],
                    description=link_data["description"]
                ),
                parse_mode="HTML"
            )
        ))
    # –í–∞–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å is_personal=True!
    await inline_query.answer(results, is_personal=True)
```

ÊúÄÂêéÔºåÊàë‰ª¨ÂæóÂà∞‰∫ÜÔºàÁ¨¨‰∫åÂº†Âî±ÁâáÁº∫Â∞ë‰∫ÜÈáëÂ∫ìÁöÑ‰∏Ä‰∏™Ê≠•È™§ `description` ÔºâÔºö

![–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Å—ã–ª–æ–∫](images/inline_mode/our_links_result.png "–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Å—ã–ª–æ–∫")

ÂΩì‰Ω†ÁÇπÂáªÂÆÉÊó∂ÔºåÂ∞±‰ºöÊî∂Âà∞ËøôÊ†∑‰∏ÄÊù°ÊºÇ‰∫ÆÁöÑ‰ø°ÊÅØÔºö

![–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ —á–∞—Ç–µ](images/inline_mode/our_links_result_in_chat.png "–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ —á–∞—Ç–µ")

#### ÊòæÁ§∫ÂõæÁâá {: id="show-images" }

ÂØπ‰∫éÂõæÂÉèÊù•ËØ¥ÔºåËøô‰∏ÄÁÇπÊØîËæÉÁÆÄÂçïÔºå‰ΩÜËøôÈáåÊúâ‰∏Ä‰∏™ÁªÜÂæÆÂ∑ÆÂà´ÔºöÊàë‰ª¨‰∏çËÉΩ‰ΩøÁî®ÂõæÂÉèÁöÑ `file_id` ‰Ωú‰∏∫ÁâπÂÆöÂèò‰ΩìÁöÑ idÔºåÂõ†‰∏∫ÂÆÉÁöÑÈïøÂ∫¶Ë∂ÖËøá‰∫Ü 64 Â≠óËäÇÔºàBot API ÈôêÂà∂Ôºâ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Â∞Ü‰ΩøÁî®ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤ÁöÑÊï∞ÁªÑ‰∏≠ÂÖÉÁ¥†ÁöÑÂ∫èÂàóÂè∑„ÄÇÈô§Ê≠§‰πãÂ§ñÔºå‰ª£Á†Å‰∏é‰πãÂâçÁöÑÈùûÂ∏∏Áõ∏‰ººÔºö

```python title="handlers/inline_mode.py"
@router.inline_query(F.query == "images")
async def show_user_images(inline_query: InlineQuery):
    results = []
    for index, file_id in enumerate(get_images_by_id(inline_query.from_user.id)):
        # –í –∏—Ç–æ–≥–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –∑–∞–ø–∏—Ö–∏–≤–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
        results.append(InlineQueryResultCachedPhoto(
            id=str(index),  # –∏–Ω–¥–µ–∫—Å —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ list
            photo_file_id=file_id
        ))
    # –í–∞–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å is_personal=True!
    await inline_query.answer(results, is_personal=True)
```

ÁªìÊûúÂë¢Ôºü

![–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ](images/inline_mode/our_images_result.png "–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ")

### Âà†Èô§Êï∞ÊçÆ {: id="delete-data" }

‰øùÂ≠òÁöÑÂÜÖÂÆπÈúÄË¶Å‰∏çÊó∂Ê∏ÖÁêÜ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨Â∏åÊúõÂÖÅËÆ∏Áî®Êà∑Âà†Èô§Á¥ØÁßØÁöÑÈìæÊé•Âíå/ÊàñÂõæÁâá„ÄÇ‰∏∫Ê≠§ÔºåÊàë‰ª¨Â∞Ü‰∏∫ `/delete` ÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™Â§ÑÁêÜÁ®ãÂ∫è„ÄÇ
‰ΩÜÊàë‰ª¨‰∏çÊÉ≥Âº∫Ëø´Áî®Êà∑ËæìÂÖ•Êú∫Âô®‰∫∫Áî®Êà∑ÂêçÂπ∂ÂÜôÂÖ• `links` Êàñ `images` „ÄÇ‰∏∫Ê≠§ÔºåÊàë‰ª¨Â∞ÜÂú®ÂëΩ‰ª§ÂìçÂ∫î‰∏ãÊîæÁΩÆ‰∏§‰∏™ÊåâÈíÆ„ÄÇ
‰∏Ä‰∏™Â∞ÜÊâìÂºÄÂÜÖËÅîÊ®°ÂºèÔºåÁî®‰∫éÊü•ÁúãÈìæÊé•ÔºåÂè¶‰∏Ä‰∏™Áî®‰∫éÊü•ÁúãÂõæÁâá„ÄÇ

Âú® `states.py` ‰∏≠Ê∑ªÂä†‰∏Ä‰∏™Êñ∞Á±ªÔºö

```python title="states.py"
class DeleteCommon(StatesGroup):
    waiting_for_delete_start = State()
```

Áé∞Âú®ÔºåËÆ©Êàë‰ª¨‰∏∫ `/delete` ÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™Â§ÑÁêÜÁ®ãÂ∫èÔºö

```python title="handlers/common.py" hl_lines="7 13"
# –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç
from aiogram.filters.state import StateFilter

@router.message(Command("delete"), StateFilter(None))
async def cmd_delete(message: Message, state: FSMContext):
    kb = []
    kb.append([
        InlineKeyboardButton(
            text="–í—ã–±—Ä–∞—Ç—å —Å—Å—ã–ª–∫—É",
            switch_inline_query_current_chat="links"
        )
    ])
    kb.append([
        InlineKeyboardButton(
            text="–í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
            switch_inline_query_current_chat="images"
        )
    ])
    await state.set_state(DeleteCommon.waiting_for_delete_start)
    await message.answer(
        text="–í—ã–±–µ—Ä–∏—Ç–µ, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å:",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=kb)
    )
```

ÁÇπÂáªËøôÊ†∑‰∏Ä‰∏™ÊåâÈíÆÔºåÂ∞±‰ºöÂ∞ÜÊâÄÈúÄÁöÑÂÄºÊõøÊç¢‰∏∫ÂÜÖËÅîÊ®°ÂºèÔºå‰ªéËÄåÁ´ãÂç≥ÊâìÂºÄ‰∏Ä‰∏™ÈìæÊé•ÊàñÂõæÁâáÂàóË°®Ôºà‰∏∫‰∫ÜÊºîÁ§∫Ëµ∑ËßÅÔºåÊàëÊöÇÊó∂ÂéªÊéâ‰∫ÜÂºπÂá∫ËèúÂçïÔºå‰ª•‰æøÊåâÈíÆÂèØËßÅÔºâÔºö

![–ö–Ω–æ–ø–∫–∞ switch_inline_query_current_chat](images/inline_mode/cmd_delete.png "–ö–Ω–æ–ø–∫–∞ switch_inline_query_current_chat")

Â¶ÇÊûúÊàë‰ª¨Âè™‰ΩøÁî® `switch_inline_query` ËÄå‰∏çÊòØ `switch_inline_query_current_chat` ÔºåTelegram Â∞±‰ºöÊèê‰æõÈÄâÊã©‰∏Ä‰∏™Áî®Êà∑ÂèØ‰ª•ÂÜô‰ø°ÁöÑËÅäÂ§©ÂÆ§ÔºåÁÑ∂ÂêéÂú®ÈÇ£ÈáåÊõøÊç¢ÊåáÂÆöÁöÑÊñáÊú¨„ÄÇ

Ââ©‰∏ãÁöÑÂ∑•‰ΩúÂ∞±ÊòØÁºñÂÜô‰∏Ä‰∏™Ë∑ØÁî±Âô®ÔºåÁî®Êù•ÊçïÊçâÂà†Èô§ËØ∑Ê±ÇÂπ∂ÁºñËæëÁâàÊú¨Â∫ìÁöÑÂÜÖÂÆπÔºö

```python title="handlers/delete_data.py"
# –∏–º–ø–æ—Ä—Ç—ã
router = Router()

@router.message(
    DeleteCommon.waiting_for_delete_start,
    F.text,
    ViaBotFilter(),
    HasLinkFilter()
)
async def link_deletion_handler(message: Message, link: str, state: FSMContext):
    delete_link(message.from_user.id, link)
    await state.clear()
    await message.answer(
        text="–°—Å—ã–ª–∫–∞ —É–¥–∞–ª–µ–Ω–∞! "
             "–í—ã–¥–∞—á–∞ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–Ω—É—Ç.")

@router.message(
    DeleteCommon.waiting_for_delete_start,
    F.photo[-1].file_unique_id.as_("file_unique_id"),
    ViaBotFilter()
)
async def image_deletion_handler(
        message: Message,
        state: FSMContext,
        file_unique_id: str
):
    delete_image(message.from_user.id, file_unique_id)
    await state.clear()
    await message.answer(
        text="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ! "
             "–í—ã–¥–∞—á–∞ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–Ω—É—Ç.")
```

ËØ∑Ê≥®ÊÑèÔºöÊàë‰ª¨ÈÄöËøá `file_unique_id` Âà†Èô§ÂõæÂÉèÔºåÂõ†‰∏∫ÊØèÊ¨°ÂèëÈÄÅÂõæÂÉèÊó∂Ôºå `file_id` ÈÉΩ‰ºö‰∏çÂêåÔºàÁÆÄËÄåË®Ä‰πãÔºöÂÆåÊï¥ÁöÑ `file_id` ÂåÖÂê´Êó∂Èó¥Êà≥ÂíåÂÖ∂‰ªñÈùûÊ∞∏‰πÖÊÄßÊï∞ÊçÆÔºâ„ÄÇ


### Switch ÁöÑÂèÇÊï∞ {: id="switch-parameter" }

Âú®ÂâçÈù¢ËÆ®ËÆ∫[ÂèëÈÄÅÂõûÂ§çÁöÑÊ†ºÂºè](#outgoing-answer-format)Êó∂ÔºåÊàë‰ª¨ÁúãÂà∞‰∫Ü‰ª• `switch_pm` ‰∏∫ÂâçÁºÄÁöÑÂèÇÊï∞„ÄÇ
ËÆ©Êàë‰ª¨‰ΩøÁî®ÂÆÉ‰ª¨ÔºåËøôÊ†∑Áî®Êà∑Â∞±ÂèØ‰ª•Áõ¥Êé•‰ªé‰ªª‰ΩïËÅäÂ§©‰∏≠Ê∑ªÂä†Êï∞ÊçÆÔºåËÄå‰∏ç‰ªÖ‰ªÖÊòØ‰ªé‰∏éÊú∫Âô®‰∫∫ÁöÑËÅäÂ§©‰∏≠Ê∑ªÂä†Êï∞ÊçÆ„ÄÇ

ËÆ©Êàë‰ª¨Â∞Ü‰∏äËø∞ÂèÇÊï∞Ê∑ªÂä†Âà∞ÂÜÖËÅîËØ∑Ê±ÇÂ§ÑÁêÜÁ®ãÂ∫è‰∏≠„ÄÇ‰∏∫Ê≠§ÔºåËÆ©Êàë‰ª¨ÈáçÂÜô `handlers/inline_mode.py` Êñá‰ª∂‰∏≠ÁöÑ `answer_inline_query()` ÊñπÊ≥ïË∞ÉÁî®Ôºö

```python
await inline_query.answer(
        results, is_personal=True,
        switch_pm_text="–î–æ–±–∞–≤–∏—Ç—å –µ—â—ë ¬ª¬ª",
        switch_pm_parameter="add"
    )
```

Âú® `/save` ÂëΩ‰ª§ÁöÑ `handlers/common.py` Â§ÑÁêÜÁ®ãÂ∫èÊñá‰ª∂‰∏≠ÔºåËÆ©Êàë‰ª¨‰ΩøÁî® `add` deeplink ÈÄöËøá `CommandStart` ËøáÊª§Âô®Ê∑ªÂä†Âè¶‰∏Ä‰∏™ÂÖ•Âè£ÁÇπÔºö

```python title="handlers/common.py" hl_lines="4"
# –Ω–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç:
from aiogram.filters.command import CommandStart

@router.message(CommandStart(magic=F.args == "add"))
@router.message(Command("save"), StateFilter(None))
async def cmd_save(message: Message, state: FSMContext):
    ...

# –£—á—Ç–∏—Ç–µ, —á—Ç–æ —Ö—ç–Ω–¥–ª–µ—Ä –Ω–∞ –ø—Ä–æ—Å—Ç–æ /start –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏ –ü–û–ó–ñ–ï
@router.message(Command(commands=["start"]))
async def cmd_start(message: Message, state: FSMContext):
    ...
```

Ê≠§Â§ñÔºåÂú®Ê∑ªÂä†ÊñáÂ≠óÂíåÂõæÁâáÁöÑÊúÄÂêé‰∏ÄÊ≠•ÔºåËÆ©Êàë‰ª¨Ê∑ªÂä†‰∏Ä‰∏™ `switch_inline_query` ÊåâÈíÆÔºåÂπ∂Âª∫ËÆÆÂ∞ùËØïÂú®Âè¶‰∏Ä‰∏™ËÅäÂ§©Â∑•ÂÖ∑‰∏≠Ê∑ªÂä†ÂÜÖÂÆπÔºö

```python
# —Ñ–∞–π–ª handlers/save_text.py
@router.message(TextSave.waiting_for_description, F.text.func(len) <= 30)
@router.message(TextSave.waiting_for_description, Command("skip"))
async def last_step(...):
    # —Ç—É—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏
    kb = [[InlineKeyboardButton(
        text="–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å",
        switch_inline_query="links"
    )]]
    await message.answer(
        text="–°—Å—ã–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=kb)
    )

# —Ñ–∞–π–ª handlers/save_images.py
@router.message(SaveCommon.waiting_for_save_start, F.photo[-1].as_("photo"))
async def save_image(...):
    # —Ç—É—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏
    kb = [[InlineKeyboardButton(
        text="–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å",
        switch_inline_query="images"
    )]]
    await message.answer(
        text="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ!",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=kb)
    )
```

ÂÜÖËÅîÊ®°ÂºèÁöÑÂè¶‰∏Ä‰∏™ÂæàÈÖ∑ÁöÑÂäüËÉΩÊòØÔºöÂ¶ÇÊûú‰Ω†ÂëºÂè´‰∏Ä‰∏™‰∏çÂú® PM ‰∏≠ÁöÑÊú∫Âô®‰∫∫ÔºåËΩ¨Âà∞ "`Ê∑ªÂä†Êõ¥Â§ö`" ÊåâÈíÆÔºåÂπ∂Âà∞ËææÊúÄÂêé‰∏ÄÊ≠•ÔºåÈÇ£‰πàÂΩìÊú∫Âô®‰∫∫Áî® `switch_inline_query` - ÊåâÈíÆÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåTelegram ÂÆ¢Êà∑Á´Ø‰ºöËá™Âä®Â∞ÜÁî®Êà∑ËøîÂõûÂà∞ÂéüÂßãËÅäÂ§©ÔºåÂπ∂Á´ãÂç≥Áî®ÊâÄÈúÄÊñáÊú¨ÊâìÂºÄÂÜÖËÅîÊ®°ÂºèÔºÅ


## Ë°•ÂÖÖËØ¥Êòé {: id="extras" }

### Âä†ËΩΩÁªìÊûú {: id="lazy-loading" }

Ê†πÊçÆÊú∫Âô®‰∫∫ API ÊñáÊ°£ÔºåÊÇ®ÊúÄÂ§öÂèØ‰ª•Âú®‰∏ÄÊ¨° [answerInlineQuery](https://core.telegram.org/bots/api#answerinlinequery) Ë∞ÉÁî®‰∏≠ÂèëÈÄÅ 50 ‰∏™È°πÁõÆ„ÄÇ
Â¶ÇÊûúÈúÄË¶ÅÊõ¥Â§öÂë¢ÔºüÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºå `next_offset` ÂèÇÊï∞Â∞±Ê¥æ‰∏äÁî®Âú∫‰∫Ü„ÄÇ
ËØ•ÂèÇÊï∞Áî±Êú∫Âô®‰∫∫Ëá™Â∑±ÊåáÂÆöÔºåÂΩìÁî®Êà∑ÊªöÂä®ÊµèËßàÂΩìÂâçÂ†ÜÊ†àÊó∂Ôºå‰∏ã‰∏Ä‰∏™ÂÜÖËÅîÊü•ËØ¢‰∏≠‰πü‰ºöÂá∫Áé∞Áõ∏ÂêåÁöÑÂÄº„ÄÇ
‰æãÂ¶ÇÔºåËÆ©Êàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊï∞Â≠óÁîüÊàêÂô®ÔºåËøîÂõûÊØèÂåÖ 50 ‰∏™È°πÁõÆÔºå‰ΩÜÊúÄÂ§ßÂÄº‰∏∫ 195 ÁöÑÊï∞Â≠óÔºö

```python title="handlers/inline_pagination_demo.py"
def get_fake_results(start_num: int, size: int = 50) -> list[int]:
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª

    :param start_num: —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —á–∏—Å–ª–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    :param size: —Ä–∞–∑–º–µ—Ä –ø–∞—á–∫–∏ (–ø–æ —É–º–æ–ª—á. 50)
    :return: —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª
    """
    overall_items = 195
    # –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–æ–ª—å—à–µ –Ω–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
    if start_num >= overall_items:
        return []
    # –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ–ø–æ–ª–Ω–æ–π –ø–∞—á–∫–∏ (–ø–æ—Å–ª–µ–¥–Ω–µ–π)
    elif start_num + size >= overall_items:
        return list(range(start_num, overall_items+1))
    else:
        return list(range(start_num, start_num+size))
```

Áé∞Âú®ÔºåËÆ©Êàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™ÂÜÖËÅîÂ§ÑÁêÜÁ®ãÂ∫èÔºåËøôÊ†∑ÂΩìÊàë‰ª¨Êé•ËøëÂΩìÂâçÂàóË°®ÁöÑÊú´Â∞æÊó∂ÔºåTelegram Â∞±‰ºöËØ∑Ê±ÇÁªßÁª≠„ÄÇ

‰∏∫Ê≠§ÔºåÊàë‰ª¨Ë¶ÅÊ£ÄÊü•ÂºÄÂ§¥ÁöÑ `offset` Â≠óÊÆµÔºåÂ¶ÇÊûú‰∏∫Á©∫ÔºåÂàôÂ∞ÜÂÖ∂ËÆæÁΩÆ‰∏∫ 1„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÁîüÊàê‰∏Ä‰∏™ÂÅáÁöÑÁªìÊûúÂàóË°®„ÄÇ
Â¶ÇÊûúËæìÂá∫Ê≠£Â•ΩÂåÖÂê´ 50 ‰∏™ÂØπË±°ÔºåÊàë‰ª¨Â∞±‰ºöÂú®ÂìçÂ∫î‰∏≠ÊåáÂÆö `next_offset` Á≠â‰∫éÂΩìÂâçÂÄº + 50„ÄÇ
Â¶ÇÊûúÂØπË±°Êï∞ÈáèËæÉÂ∞ëÔºåÊàë‰ª¨Â∞±‰∏çÊåáÂÆö‰ªª‰ΩïÂÜÖÂÆπÔºåËøôÊ†∑ Telegram Â∞±‰∏ç‰ºöÂÜçÊ¨°Â∞ùËØïÂä†ËΩΩÊñ∞Â≠óÁ¨¶‰∏≤Ôºö

```python title="handlers/inline_pagination_demo.py" hl_lines="21"
@router.inline_query(F.query == "long")
async def pagination_demo(
        inline_query: InlineQuery,
):
    # –í—ã—Å—á–∏—Ç—ã–≤–∞–µ–º offset –∫–∞–∫ —á–∏—Å–ª–æ
    offset = int(inline_query.offset) if inline_query.offset else 1
    results = [InlineQueryResultArticle(
        id=str(item_num),
        title=f"–û–±—ä–µ–∫—Ç ‚Ññ{item_num}",
        input_message_content=InputTextMessageContent(
            message_text=f"–û–±—ä–µ–∫—Ç ‚Ññ{item_num}"
        )
    ) for item_num in get_fake_results(offset)]
    if len(results) < 50:
        await inline_query.answer(
            results, is_personal=True
        )
    else:
        await inline_query.answer(
            results, is_personal=True, 
            next_offset=str(offset+50)
        )
```

ÂΩìÊú∫Âô®‰∫∫ÊªöÂä®ÊµèËßàÂÜÖËÅîÁªìÊûúÊó∂ÔºåÂÆÉÂ∞ÜÊé•Êî∂Êü•ËØ¢Âπ∂ËøîÂõûË∂äÊù•Ë∂äÂ§öÁöÑÁªìÊûúÔºåÁõ¥Âà∞Âà∞ËææÁ¨¨ 195 ‰∏™ÂÖÉÁ¥†Êó∂ÔºåÊü•ËØ¢Êâç‰ºöÂÅúÊ≠¢„ÄÇ

### ÂÜÖËÅîÂèçÈ¶à {: id="inline-feedback" }

ËôΩÁÑ∂Áü•ÈÅìÁöÑ‰∫∫‰∏çÂ§öÔºå‰ΩÜ Telegram ÂÖÅËÆ∏ÊÇ®Âú®ÂÜÖËÅîÊ®°Âºè‰∏ãÊî∂ÈõÜÊúâÂÖ≥Êú∫Âô®‰∫∫‰ΩøÁî®ÊÉÖÂÜµÁöÑÁÆÄÂçïÁªüËÆ°Êï∞ÊçÆ„ÄÇ
Ë¶ÅÂºÄÂßã‰ΩøÁî®ÔºåÊÇ®ÈúÄË¶Å‰∏∫ @BotFather ÂêØÁî®Áõ∏Â∫îÁöÑËÆæÁΩÆÔºö `/mybots -ÔºàÈÄâÊã©Êú∫Âô®‰∫∫Ôºâ - Êú∫Âô®‰∫∫ËÆæÁΩÆ - ÂÜÖËÅîÂèçÈ¶à`Ôºö

![–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ @imdb –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ](images/inline_mode/botfather_inline_feedback.png "–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ @imdb –≤ –∏–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ")

ÊåâÈíÆ‰∏äÁöÑÊï∞Â≠óË°®Á§∫Áî®Êà∑Âú®ÂÜÖËÅîÊ®°Âºè‰∏ãÈÄâÊã©ÂØπË±°Êó∂Êî∂Âà∞ [ChosenInlineResult](https://core.telegram.org/bots/api#choseninlineresult) ‰∫ã‰ª∂ÁöÑÊ¶ÇÁéá„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûúÂÄºËÆæÁΩÆ‰∏∫ 10%ÔºåÈÇ£‰πàÊØèÊ¨°ÈÄâÊã©ÂØπË±°Êó∂ÔºåÊú∫Âô®‰∫∫Â∞±Êúâ 10% ÁöÑÊ¶ÇÁéáÊî∂Âà∞ ChosenInlineResult ‰∫ã‰ª∂„ÄÇTelegram ‰∏çÂª∫ËÆÆÂ∞ÜÂÄºËÆæ‰∏∫ 100%ÔºåÂõ†‰∏∫Ëøô‰ºöÂä†ÂÄçÊú∫Âô®‰∫∫ÁöÑË¥üËΩΩ„ÄÇÂõ†Ê≠§ÔºåËØ•ÂäüËÉΩÂπ∂‰∏çÈÄÇÂêàÁî®‰∫é‰ªª‰Ωï‰∏•ËÇÉÁöÑÂàÜÊûêÔºå‰ΩÜÂ¶ÇÊûúÊäÄÊúØÂ®¥ÁÜüÔºåÁªèËøáÈïøÊó∂Èó¥‰ΩøÁî®ÔºåÂÆÉÂèØ‰ª•Êèê‰æõÊúÄÊúâÁî®ÁöÑÂÜÖËÅîÁªìÊûúÁöÑÂ§ßËá¥‰ø°ÊÅØ„ÄÇÊ≠§Á±ª‰∫ã‰ª∂ÁöÑÂ§ÑÁêÜÁ®ãÂ∫èÁ§∫‰æãÔºö

```python title="handlers/inline_chosen_result_demo.py"
from aiogram import Router
from aiogram.types import ChosenInlineResult

router = Router()

@router.chosen_inline_result()
async def pagination_demo(
        chosen_result: ChosenInlineResult,
):
    # –ü–∏—à–µ–º –ø—Ä—è–º–æ –Ω–∞ —ç–∫—Ä–∞–Ω. –ù–æ, –≤–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫—É–¥–∞-—Ç–æ
    print(
        f"After '{chosen_result.query}' query, "
        f"user chose option with ID '{chosen_result.result_id}'"
    )
```

Â∞ΩÁÆ° Telegram ‰∏çÂª∫ËÆÆ‰∏∫ "`ÂÜÖËÅîÂèçÈ¶à`" ËÆæÁΩÆËæÉÂ§ßÁöÑÂÄºÔºå‰ΩÜÂÆÉËá≥Â∞ëÊúâ‰∏Ä‰∏™ÂÆûÈôÖÁî®ÈÄîÔºöÊúâ‰∫õÈü≥‰πêÊú∫Âô®‰∫∫‰ºöÂ∞ùËØïÊåâÈúÄ‰∏ãËΩΩÊ≠åÊõ≤ÁöÑÂÆåÊï¥ÁâàÊú¨ÔºåËÄå‰∏ç‰∫ãÂÖà‰øùÂ≠òÊ≠åÊõ≤„ÄÇÂ¶ÇÊûúÂú®ÂÜÖËÅîÊ®°Âºè‰∏ãË∞ÉÁî®Êú∫Âô®‰∫∫ÔºåÂèØËÉΩÊó†Ê≥ïÂú® 10-15 ÁßíÂÜÖÂÆåÊàê‰∏ãËΩΩÔºå‰πãÂêéÊú∫Âô®‰∫∫ API ‰ºöËøîÂõû‰∏Ä‰∏™ÂÖ≥‰∫é "`ËøáÊúü`" Êõ¥Êñ∞ÁöÑÈîôËØØ„ÄÇ

ÂºÄÂèë‰∫∫ÂëòÊòØËøôÊ†∑ÂÅöÁöÑÔºöÂΩìÊú∫Âô®‰∫∫ÊêúÁ¥¢Êõ≤ÁõÆÊó∂Ôºå‰ºöÂú®È¢ÑËßà‰∏≠Êèê‰æõ‰∏Ä‰∏™ÁÆÄÁü≠ÁöÑÊ†∑Êú¨Ôºà5-10 ÁßíÔºâ„ÄÇ
ÂΩìÁî®Êà∑ÁÇπÂáªÊüê‰∏ÄË°åÊó∂ÔºåÁ≥ªÁªü‰ºöÂèëÈÄÅ‰∏ÄÊù°Èü≥È¢ë‰ø°ÊÅØÔºåÂπ∂ÈôÑÂ∏¶‰∏Ä‰∏™ÂÜÖÂµåÊåâÈíÆÔºàÂê¶ÂàôÊó†Ê≥ïÁºñËæë‰ø°ÊÅØÔºâÔºå
Êú∫Âô®‰∫∫‰ºöÊçïÊçâÂà∞ÂèëÈÄÅ‰∫ã‰ª∂Ôºå‰ªé `ChosenInlineResult` Á±ªÂûãÁöÑÊõ¥Êñ∞‰∏≠ÊèêÂèñ‰ø°ÊÅØÁöÑ `inline_message_id` Á´ØÂà∞Á´Ø `inline_message_id` Ôºå
Âä†ËΩΩÂÆåÊï¥ÁâàÊú¨ÁöÑÈü≥È¢ëÔºåÂπ∂‰ΩøÁî®ËØ• `inline_message_id` Â∞ÜÊ†∑Êú¨ÁºñËæëÊàêÂÆåÊï¥ÁöÑÊõ≤ÁõÆ„ÄÇÊ≤°ÈîôÔºåTelegram Â∑≤ÁªèÂºÄÂßã‰π†ÊÉØ‰ΩøÁî®ÊãêÊùñ‰∫Ü„ÄÇ
