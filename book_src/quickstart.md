---
title: äº†è§£aiogram
description: äº†è§£aiogram
---

# äº†è§£aiogram

!!! info ""
    ä½¿ç”¨çš„ aiogram ç‰ˆæœ¬ï¼š 3.1.1

!!! warning "ä¸€äº›ç»†èŠ‚åˆ»æ„ç®€åŒ–ï¼"
    æœ¬ä¹¦ä½œè€…æ·±ä¿¡ï¼Œç†è®ºä¹‹å¤–è¿˜åº”æœ‰å®è·µã€‚ä¸ºäº†å°½å¯èƒ½æ–¹ä¾¿åœ°é‡å¤ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é‡‡ç”¨åªé€‚åˆæœ¬åœ°å¼€å‘å’ŒåŸ¹è®­çš„æ–¹æ³•ã€‚

    ä¾‹å¦‚ï¼Œåœ¨æ‰€æœ‰æˆ–å‡ ä¹æ‰€æœ‰ç« èŠ‚ä¸­ï¼Œæœºå™¨äººä»¤ç‰Œéƒ½ä¼šç›´æ¥åœ¨æºä»£ç ä¸­æŒ‡å®šã€‚è¿™æ˜¯ä¸€ç§ç³Ÿç³•çš„åšæ³•ï¼Œå› ä¸ºå¦‚æœåœ¨å°†ä»£ç ä¸Šä¼ åˆ°å…¬å…±ä»“åº“ï¼ˆå¦‚ GitHubï¼‰ä¹‹å‰å¿˜è®°åˆ é™¤ï¼Œå°±ä¼šå¯¼è‡´ä»¤ç‰Œæ³„éœ²ã€‚

    æœ‰æ—¶ï¼Œå®Œå…¨ä½äº RAM ä¸­çš„ç»“æ„ï¼ˆå­—å…¸ã€åˆ—è¡¨......ï¼‰ä¹Ÿä¼šè¢«ç”¨ä½œæ•°æ®å­˜å‚¨ç©ºé—´ã€‚äº‹å®ä¸Šï¼Œè¿™æ ·çš„å¯¹è±¡å¹¶ä¸å¯å–ï¼Œå› ä¸ºåœæ­¢æœºå™¨äººä¼šå¯¼è‡´æ— æ³•æŒ½å›çš„æ•°æ®ä¸¢å¤±ã€‚

    æˆ‘ä»¬è¿˜é€‰æ‹©äº†è½®è¯¢ä½œä¸ºä» Telegram æ¥æ”¶æ›´æ–°çš„æœºåˆ¶ï¼Œå› ä¸ºå®ƒèƒ½ä¿è¯åœ¨ç»å¤§å¤šæ•°ç¯å¢ƒä¸‹æ­£å¸¸å·¥ä½œï¼Œå‡ ä¹é€‚åˆæ‰€æœ‰å¼€å‘äººå‘˜ã€‚

    **é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œä½œè€…çš„ç›®çš„æ˜¯å‡†ç¡®è§£é‡Šå¦‚ä½•ä½¿ç”¨aiogramæ¥ä½¿ç”¨Telegram Bot APIï¼Œè€Œä¸æ˜¯è§£é‡Šæ•´ä¸ªè®¡ç®—æœºç§‘å­¦çš„å¤šæ ·æ€§ã€‚**

## æœ¯è¯­ {: id="glossary" }

ä¸ºäº†ç”¨åŒæ ·çš„æœ¯è¯­è¯´è¯ï¼Œè®©æˆ‘ä»¬æ¥ä»‹ç»ä¸€äº›æœ¯è¯­ï¼Œä»¥å…ä»Šåæ··æ·†ï¼š

* PM â€” æ˜¯ç§äººä¿¡æ¯ï¼Œåœ¨æœºå™¨äººä¸­æ˜¯ä¸ç”¨æˆ·ä¸€å¯¹ä¸€çš„å¯¹è¯ï¼Œè€Œä¸æ˜¯ç¾¤ç»„/é¢‘é“ã€‚
* èŠå¤© â€” æ˜¯ PMã€ç¾¤ç»„ã€è¶…çº§ç¾¤ç»„å’Œé¢‘é“çš„ç»Ÿç§°ã€‚
* æ›´æ–° â€” æ­¤[åˆ—è¡¨](https://core.telegram.org/bots/api#update)ä¸­çš„ä»»ä½•äº‹ä»¶ï¼š å‘å¸–ã€å¸–å­ç¼–è¾‘ã€å›å¸–ã€å†…è”è¯·æ±‚ã€ä»˜æ¬¾ã€å‘ç»„æ·»åŠ æœºå™¨äººç­‰ã€‚
* å¤„ç†ç¨‹åº â€” æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œç”¨äºæ¥æ”¶æ¥è‡ªè°ƒåº¦å™¨/è·¯ç”±å™¨çš„ä¸‹ä¸€æ¬¡æ›´æ–°å¹¶è¿›è¡Œå¤„ç†ã€‚
* Dispatcher(è°ƒåº¦å™¨) â€” æ˜¯ä¸€ä¸ªä» Telegram æ¥æ”¶æ›´æ–°ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå¥æŸ„æ¥å¤„ç†æ¥æ”¶åˆ°çš„æ›´æ–°çš„å¯¹è±¡ã€‚
* è·¯ç”±å™¨ â€” ä¸è°ƒåº¦ç¨‹åºç±»ä¼¼ï¼Œä½†è´Ÿè´£å¤šä¸ªå¤„ç†ç¨‹åºçš„å­é›†ã€‚
**å¯ä»¥è¯´ï¼Œè°ƒåº¦å™¨æ˜¯æ ¹è·¯ç”±å™¨ã€‚**.
* è¿‡æ»¤å™¨ â€” æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé€šå¸¸è¿”å› `True` æˆ– `False`ï¼Œå¹¶å½±å“å¤„ç†ç¨‹åºæ˜¯å¦è¢«è°ƒç”¨ã€‚
* ä¸­é—´ä»¶ â€” æ˜¯åµŒå…¥åˆ°æ›´æ–°å¤„ç†ä¸­çš„ä¸€ä¸ªå±‚ã€‚

## å®‰è£… {: id="installation" }

é¦–å…ˆï¼Œä¸ºæœºå™¨äººåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼ˆä»¥ä¸‹ç®€ç§° venvï¼‰ï¼Œå¹¶å®‰è£… [aiogram](https://github.com/aiogram/aiogram) åº“ã€‚
è®©æˆ‘ä»¬æ£€æŸ¥æ˜¯å¦å®‰è£…äº† Python 3.9 ç‰ˆæœ¬ï¼ˆå¦‚æœå·²ç»å®‰è£…äº† 3.9 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯ä»¥è·³è¿‡æœ¬èŠ‚ï¼‰ï¼š

```plain
[groosha@main lesson_01]$ python3.9
Python 3.9.9 (main, Jan 11 2022, 16:35:07) 
[GCC 11.1.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> exit()
[groosha@main lesson_01]$ 
```

ç°åœ¨åˆ›å»ºä¸€ä¸ª `requirements.txt` æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æŒ‡å®šæˆ‘ä»¬ä½¿ç”¨çš„ aiogram ç‰ˆæœ¬ã€‚é…ç½®æ–‡ä»¶è¿˜éœ€è¦ä½¿ç”¨ python-dotenv åº“ã€‚
!!! important "å…³äº aiogram ç‰ˆæœ¬"
    æœ¬ç« ä½¿ç”¨çš„æ˜¯ aiogram 3.xï¼Œåœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å»ºè®®æŸ¥çœ‹åº“çš„å‘å¸ƒæ¸ é“ï¼Œä»¥è·å–æ›´æ–°çš„ç‰ˆæœ¬ã€‚ä»»ä½•ä»¥ **3** å¼€å¤´çš„æ–°ç‰ˆæœ¬éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå› ä¸º aiogram 2.x ä¸å†è¢«è€ƒè™‘ä½¿ç”¨ï¼Œå·²è¢«è§†ä¸ºå¼ƒç”¨ç‰ˆæœ¬ã€‚

```plain
[groosha@main 01_quickstart]$ python3.9 -m venv venv
[groosha@main 01_quickstart]$ echo "aiogram<4.0" > requirements.txt
[groosha@main 01_quickstart]$ echo "python-dotenv==1.0.0" >> requirements.txt
[groosha@main 01_quickstart]$ source venv/bin/activate
(venv) [groosha@main 01_quickstart]$ pip install -r requirements.txt 
# ...Ğ·Ğ´ĞµÑÑŒ ĞºÑƒÑ‡Ğ° ÑÑ‚Ñ€Ğ¾Ğº Ğ¿Ñ€Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºÑƒ...
Successfully installed ...Ñ‚ÑƒÑ‚ Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº...
[groosha@main 01_quickstart]$
```

æ³¨æ„ç»ˆç«¯ä¸­çš„å‰ç¼€ `venv`ã€‚è¿™è¡¨æ˜æˆ‘ä»¬æ­£å¤„äºä¸€ä¸ªåä¸º `venv` çš„è™šæ‹Ÿç¯å¢ƒä¸­ã€‚è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ `venv` ä¸­çš„ `python` å‘½ä»¤è°ƒç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ª `Python 3.9`ï¼š 
```plain
(venv) [groosha@main 01_quickstart]$ python
Python 3.9.9 (main, Jan 11 2022, 16:35:07) 
[GCC 11.1.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> exit()
(venv) [groosha@main 01_quickstart]$ deactivate 
[groosha@main 01_quickstart]$ 
```

éšç€æœ€åä¸€æ¡ `deactivate` å‘½ä»¤çš„ä¸‹è¾¾ï¼Œæˆ‘ä»¬ç¦»å¼€äº† `VENV`ï¼Œè¿™æ ·ä»–å°±ä¸ä¼šæ¥æ‰“æ‰°æˆ‘ä»¬äº†ã€‚

!!! info ""
    å¦‚æœæ‚¨ä½¿ç”¨ PyCharm ç¼–å†™æœºå™¨äººï¼Œæˆ‘è¿˜å»ºè®®æ‚¨å®‰è£…ç¬¬ä¸‰æ–¹ [Pydantic](https://plugins.jetbrains.com/plugin/12861-pydantic) æ’ä»¶ï¼Œä»¥æ”¯æŒ Telegram å¯¹è±¡ä¸­çš„è‡ªåŠ¨å®Œæˆä»£ç ã€‚

## ç¬¬ä¸€ä¸ªæœºå™¨äºº {: id="hello-world" }

è®©æˆ‘ä»¬åœ¨ aiogram ä¸Šåˆ›å»ºä¸€ä¸ªå¸¦æœ‰åŸºæœ¬æœºå™¨äººæ¨¡æ¿çš„ `bot.py` æ–‡ä»¶ï¼š
```python title="bot.py"
import asyncio
import logging
from aiogram import Bot, Dispatcher, types
from aiogram.filters.command import Command

# å¯ç”¨æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œä»¥å…é”™è¿‡é‡è¦ä¿¡æ¯
logging.basicConfig(level=logging.INFO)
# æœºå™¨äººå¯¹è±¡
bot = Bot(token="12345678:AaBbCcDdEeFfGgHh")
# è°ƒåº¦å™¨
dp = Dispatcher()

# /start å‘½ä»¤çš„å¤„ç†ç¨‹åº
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    await message.answer("Hello!")

# å¼€å§‹è½®è¯¢æ–°çš„æ›´æ–°
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
```

é¦–å…ˆï¼šaiogram æ˜¯ä¸€ä¸ªå¼‚æ­¥åº“ï¼Œæ‰€ä»¥ä½ çš„å¤„ç†ç¨‹åºä¹Ÿåº”è¯¥æ˜¯å¼‚æ­¥çš„ï¼Œè€Œä¸”ä½ åº”è¯¥åœ¨ API æ–¹æ³•è°ƒç”¨ä¹‹å‰åŠ ä¸Š `await` å…³é”®å­—ï¼Œå› ä¸ºè¿™äº›è°ƒç”¨ä¼šè¿”å› [coroutines](https://docs.python.org/3/library/asyncio-task.html#coroutines)ã€‚

!!! info "Python å¼‚æ­¥ç¼–ç¨‹"
    æ­£å¼æ–‡ä»¶ä¹Ÿä¸å®¹å¿½è§†ï¼
    Python ç½‘ç«™ä¸Šæœ‰å…³äº [asyncio](https://docs.python.org/3/library/asyncio-task.html) çš„ç²¾å½©æ•™ç¨‹ã€‚

å¦‚æœä½ è¿‡å»ä½¿ç”¨è¿‡å…¶ä»– Telegram åº“ï¼Œä¾‹å¦‚ pyTelegramBotAPIï¼Œä½ å°±ä¼šç«‹å³ç†è§£å¤„ç†ç¨‹åºï¼ˆäº‹ä»¶å¤„ç†ç¨‹åºï¼‰çš„æ¦‚å¿µï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œåœ¨ aiogram ä¸­ï¼Œå¤„ç†ç¨‹åºç”±è°ƒåº¦ç¨‹åºç®¡ç†ã€‚

è°ƒåº¦ç¨‹åºä¼šæ³¨å†Œå¤„ç†å‡½æ•°ï¼Œå¹¶é€šè¿‡è¿‡æ»¤å™¨é™åˆ¶è°ƒç”¨è¿™äº›å‡½æ•°çš„äº‹ä»¶åˆ—è¡¨ã€‚åœ¨æ¥æ”¶åˆ°ä¸‹ä¸€æ¬¡æ›´æ–°ï¼ˆæ¥è‡ª Telegram çš„äº‹ä»¶ï¼‰åï¼Œè°ƒåº¦ç¨‹åºå°†é€‰æ‹©ç¬¦åˆæ‰€æœ‰ç­›é€‰æ¡ä»¶çš„å¿…è¦å¤„ç†å‡½æ•°ï¼Œä¾‹å¦‚ *å¤„ç† ID ä¸º xã€ç­¾åé•¿åº¦ä¸º ygk çš„èŠå¤©å›¾åƒä¿¡æ¯*ã€‚å¦‚æœä¸¤ä¸ªå‡½æ•°çš„è¿‡æ»¤å™¨ç›¸åŒï¼Œåˆ™ä¼šè°ƒç”¨è¾ƒæ—©æ³¨å†Œçš„é‚£ä¸ªã€‚

è¦å°†å‡½æ•°æ³¨å†Œä¸ºæ¶ˆæ¯å¤„ç†ç¨‹åºï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹ä¸¤ä»¶äº‹ä¹‹ä¸€ï¼š 

1. æŒ‚ä¸Šä¸€ä¸ªè£…é¥°å™¨ï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­ã€‚ç¨åæˆ‘ä»¬å°†äº†è§£ä¸åŒç±»å‹çš„[è£…é¥°å™¨](https://devpractice.ru/python-lesson-19-decorators/)ã€‚
2. ç›´æ¥è°ƒç”¨è°ƒåº¦å™¨æˆ–è·¯ç”±å™¨çš„æ³¨å†Œæ–¹æ³•ã€‚

è¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š
```python
# /test1 å‘½ä»¤çš„å¤„ç†ç¨‹åº
@dp.message(Command("test1"))
async def cmd_test1(message: types.Message):
    await message.reply("Test 1")

# /test2 å‘½ä»¤çš„å¤„ç†ç¨‹åº
async def cmd_test2(message: types.Message):
    await message.reply("Test 2")
```

è®©æˆ‘ä»¬ç”¨å®ƒè¿è¡Œä¸€ä¸ªæœºå™¨äººï¼š 
![/test2 å‘½ä»¤ä¸èµ·ä½œç”¨](images/quickstart/l01_1.jpg)

å¤„ç†ç¨‹åº `cmd_test2` å°†æ— æ³•å·¥ä½œï¼Œå› ä¸ºè°ƒåº¦ç¨‹åºä¸çŸ¥é“å®ƒã€‚è®©æˆ‘ä»¬ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼Œå¹¶å•ç‹¬æ³¨å†Œè¯¥å‡½æ•°ï¼š
```python
# /test2 å‘½ä»¤çš„å¤„ç†ç¨‹åº
async def cmd_test2(message: types.Message):
    await message.reply("Test 2")

# å…¶ä»–åœ°æ–¹ï¼Œä¾‹å¦‚åœ¨ main() å‡½æ•°ä¸­ï¼š
dp.message.register(cmd_test2, Command("test2"))
```

è®©æˆ‘ä»¬å†æ¬¡è¿è¡Œæœºå™¨äººï¼š 
![ĞĞ±Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚](images/quickstart/l01_2.jpg)

## è¯­æ³•ç³– {: id="sugar" }

ä¸ºäº†ä½¿ä»£ç æ›´ç®€æ´æ˜“è¯»ï¼Œaiogram æ‰©å±•äº†æ ‡å‡† Telegram å¯¹è±¡çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å†™ `message.answer(...)` æˆ– `message.reply(...)` æ¥ä»£æ›¿ `bot.send_message(...)` ã€‚åœ¨åä¸¤ç§æƒ…å†µä¸‹ï¼Œæ‚¨ä¸éœ€è¦æ›¿æ¢ `chat_id` ï¼Œå› ä¸ºå®ƒè¢«è®¤ä¸ºä¸åŸå§‹ä¿¡æ¯ä¸­çš„å†…å®¹ç›¸åŒã€‚

`answer` å’Œ `reply` ä¹‹é—´çš„åŒºåˆ«å¾ˆç®€å•ï¼šç¬¬ä¸€ç§æ–¹æ³•åªæ˜¯å‘åŒä¸€ä¸ªèŠå¤©å®¤å‘é€æ¶ˆæ¯ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯ `å›å¤` æ¥è‡ª `message` çš„æ¶ˆæ¯ï¼š
```python
@dp.message(Command("answer"))
async def cmd_answer(message: types.Message):
    await message.answer("ç­”æ¡ˆå¾ˆç®€å•")


@dp.message(Command("reply"))
async def cmd_reply(message: types.Message):
    await message.reply('è¿™æ˜¯ä¸€ä¸ªæœ‰ "ç­”æ¡ˆ "çš„ç­”æ¡ˆ')
```
![Ğ Ğ°Ğ·Ğ½Ğ¸Ñ†Ğ° Ğ¼ĞµĞ¶Ğ´Ñƒ message.answer() Ğ¸ message.reply()](images/quickstart/l01_3.jpg)

æ­¤å¤–ï¼Œå¤§å¤šæ•°æ¶ˆæ¯ç±»å‹éƒ½æœ‰ `answer_{type}` æˆ– `reply_{type}` ç­‰è¾…åŠ©æ–¹æ³•ï¼š
```python
@dp.message(Command("dice"))
async def cmd_dice(message: types.Message):
    await message.answer_dice(emoji="ğŸ²")
```

!!! info "'message: types.Message' æ˜¯ä»€ä¹ˆ?"
    Python æ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œå…·æœ‰å¼ºåŠ¨æ€ç±»å‹ï¼Œå› æ­¤æ²¡æœ‰åƒ C++ æˆ– Java é‚£æ ·çš„[å†…ç½®ç±»å‹æ£€æŸ¥](https://zh.wikipedia.org/zh-cn/%E9%A1%9E%E5%9E%8B%E7%B3%BB%E7%B5%B1#%E5%9E%8B%E5%88%A5%E6%AA%A2%E6%9F%A5)ã€‚
    ä¸è¿‡ï¼Œä» 3.5 ç‰ˆå¼€å§‹ï¼Œè¯¥è¯­è¨€å¼•å…¥äº†å¯¹[ç±»å‹æç¤º](https://docs.python.org/zh-cn/3/library/typing.html)çš„æ”¯æŒï¼Œè¿™æ ·å„ç§æ£€æŸ¥å™¨å’Œé›†æˆå¼€å‘ç¯å¢ƒï¼ˆå¦‚ PyCharmï¼‰å°±èƒ½åˆ†ææ‰€ç”¨å€¼çš„ç±»å‹ï¼Œå¹¶åœ¨ä¼ é€’é”™è¯¯å€¼æ—¶æç¤ºç¨‹åºå‘˜ã€‚
    åœ¨æœ¬ä¾‹ä¸­ï¼Œ`types.Message`æç¤ºå‘Šè¯‰ PyCharmï¼Œ`message`å˜é‡å…·æœ‰ aiogram åº“çš„`types`æ¨¡å—ä¸­æè¿°çš„`Message`ç±»å‹ï¼ˆå‚è§ä»£ç å¼€å¤´çš„å¯¼å…¥ï¼‰ã€‚
    è¿™æ ·ï¼ŒIDE å°±èƒ½å³æ—¶å»ºè®®å±æ€§å’Œå‡½æ•°ã€‚

è°ƒç”¨`/dice`æ—¶ï¼Œæœºå™¨äººå°†å‘åŒä¸€ä¸ªèŠå¤©å®¤å‘é€éª°å­ã€‚å½“ç„¶ï¼Œå¦‚æœæ‚¨æƒ³å°†éª°å­å‘é€åˆ°å…¶ä»–èŠå¤©å®¤ï¼Œå°±å¿…é¡»ç”¨è€æ–¹æ³•è°ƒç”¨`await bot.send_dice(...)`ã€‚
ä½†æ˜¯ï¼Œ`bot`å¯¹è±¡ï¼ˆBot ç±»çš„å®ä¾‹ï¼‰åœ¨ç‰¹å®šå‡½æ•°çš„ä½œç”¨åŸŸä¸­å¯èƒ½ä¸å¯ç”¨ã€‚åœ¨ aiogram 3.x ä¸­ï¼Œæ¥æ”¶æ›´æ–°çš„æœºå™¨äººå¯¹è±¡ä¼šè¢«éšå¼åœ°æŠ›å…¥å¤„ç†ç¨‹åºï¼Œå¹¶å¯ä½œä¸º`bot`çš„å‚æ•°åˆ°è¾¾ã€‚
å‡è®¾ä½ æƒ³åœ¨`/dice`å‘½ä»¤ä¸­å‘é€ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œä½†ä¸æ˜¯å‘é€åˆ°åŒä¸€ä¸ªèŠå¤©å®¤ï¼Œè€Œæ˜¯å‘é€åˆ° ID ä¸º -100123456789 çš„é¢‘é“ã€‚è®©æˆ‘ä»¬é‡å†™ä¹‹å‰çš„å‡½æ•°ï¼š

```python
# ä¸è¦å¿˜è®°å¯¼å…¥
from aiogram.enums.dice_emoji import DiceEmoji

@dp.message(Command("dice"))
async def cmd_dice(message: types.Message, bot: Bot):
    await bot.send_dice(-100123456789, emoji=DiceEmoji.DICE)
```

## ä¼ è¾“é™„åŠ å‚æ•° {: id="pass-extras" }

æœ‰æ—¶ï¼Œè¿è¡Œæœºå™¨äººæ—¶å¯èƒ½éœ€è¦ä¼ é€’ä¸€ä¸ªæˆ–å¤šä¸ªé™„åŠ å€¼ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå˜é‡ã€ä¸€ä¸ªé…ç½®å¯¹è±¡ã€ä¸€ä¸ªåˆ—è¡¨ã€ä¸€ä¸ªæ—¶é—´æˆ³æˆ–å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚ä¸ºæ­¤ï¼Œåªéœ€å°†è¿™äº›æ•°æ®ä½œä¸ºå‘½åï¼ˆkwargsï¼‰å‚æ•°ä¼ é€’ç»™è°ƒåº¦ç¨‹åºï¼Œæˆ–è€…åƒå¤„ç†å­—å…¸ä¸€æ ·èµ‹å€¼ã€‚

è¯¥åŠŸèƒ½æœ€é€‚ç”¨äºä¼ é€’å•ä¸ªå®ä¾‹ä¸­çš„å¯¹è±¡ï¼Œåœ¨æœºå™¨äººæ“ä½œè¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼ˆå³åªè¯»ï¼‰ã€‚å¦‚æœå€¼ä¼šéšæ—¶é—´å‘ç”Ÿå˜åŒ–ï¼Œè¯·è®°ä½è¿™åªé€‚ç”¨äº[å¯å˜å¯¹è±¡](https://mathspp.com/blog/pydonts/pass-by-value-reference-and-assignment)ã€‚è¦åœ¨å¤„ç†ç¨‹åºä¸­è·å–å€¼ï¼Œåªéœ€å°†å…¶æŒ‡å®šä¸ºå‚æ•°å³å¯ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

```python
# åœ¨åˆ«çš„åœ°æ–¹
# ä¾‹å¦‚ï¼Œåœ¨åº”ç”¨ç¨‹åºå…¥å£ç‚¹
from datetime import datetime

# bot = ...
dp = Dispatcher()
dp["started_at"] = datetime.now().strftime("%Y-%m-%d %H:%M")
await dp.start_polling(bot, mylist=[1, 2, 3])


@dp.message(Command("add_to_list"))
async def cmd_add_to_list(message: types.Message, mylist: list[int]):
    mylist.append(7)
    await message.answer("æ·»åŠ äº†æ•°å­— 7")


@dp.message(Command("show_list"))
async def cmd_show_list(message: types.Message, mylist: list[int]):
    await message.answer(f"åˆ—è¡¨æ¸…å•: {mylist}")

    
@dp.message(Command("info"))
async def cmd_info(message: types.Message, started_at: str):
    await message.answer(f"æœºå™¨äººå¯åŠ¨äº {started_at}")
```

ç°åœ¨ï¼Œ`started_at`å˜é‡å’Œ`mylist`åˆ—è¡¨å¯ä»¥åœ¨ä¸åŒçš„å¤„ç†ç¨‹åºä¸­è¯»å–å’Œå†™å…¥ã€‚å¦‚æœæ‚¨éœ€è¦ä¸ºæ¯æ¬¡æ›´æ–°ï¼ˆä¾‹å¦‚ DBMS ä¼šè¯å¯¹è±¡ï¼‰æŠ›å‡ºå”¯ä¸€å€¼ï¼Œè¯·æŸ¥çœ‹ [ä¸­é—´ä»¶](filters-and-middlewares.md#middlewares)ã€‚

![ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚ mylist Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½Ñ‘Ğ½ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ°Ğ¼Ğ¸](images/quickstart/extra-args.png)

## é…ç½®æ–‡ä»¶

ä¸ºäº†é¿å…ç›´æ¥åœ¨ä»£ç ä¸­å­˜å‚¨ä»¤ç‰Œï¼ˆå¦‚æœä½ æƒ³æŠŠæœºå™¨äººä¸Šä¼ åˆ°å…¬å…±ä»“åº“æ€ä¹ˆåŠï¼Ÿæœ‰ä¸€ç§è§‚ç‚¹è®¤ä¸ºï¼Œç¯å¢ƒå˜é‡è¶³ä»¥æ»¡è¶³é”€å”®çš„éœ€è¦ï¼Œä½†åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å•ç‹¬çš„ `.env` æ–‡ä»¶æ¥ç®€åŒ–æˆ‘ä»¬çš„ç”Ÿæ´»ï¼Œå¹¶ä¸ºè¯»è€…èŠ‚çœéƒ¨ç½²æ¼”ç¤ºé¡¹ç›®çš„æ—¶é—´ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬åœ¨ `bot.py` æ—è¾¹åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ `config_reader.py` ï¼Œå†…å®¹å¦‚ä¸‹

```python title="config_reader.py"
from pydantic_settings import BaseSettings, SettingsConfigDict
from pydantic import SecretStr


class Settings(BaseSettings):
    # æœ€å¥½ä½¿ç”¨ SecretStr è€Œä¸æ˜¯ str 
    # å¯¹äºæ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚æœºå™¨äººä»¤ç‰Œ
    bot_token: SecretStr

    # ä» pydantic çš„ç¬¬äºŒä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œè®¾ç½®äº† settings ç±»è®¾ç½®
    # é€šè¿‡ model_config
    # åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ä½¿ç”¨è¯»å–çš„ .env æ–‡ä»¶
    # ä½¿ç”¨ UTF-8 ç¼–ç 
    model_config = SettingsConfigDict(env_file='.env', env_file_encoding='utf-8')


# å¯¼å…¥æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šç«‹å³åˆ›å»º
# å¹¶ä¸”é…ç½®å¯¹è±¡å·²éªŒè¯ï¼Œ
# å¯ä»ä¸åŒåœ°æ–¹è¿›ä¸€æ­¥å¯¼å…¥
config = Settings()
```

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¨å¾®ç¼–è¾‘ä¸€ä¸‹ `bot.py` ï¼š

```python title="bot.py"
# å¯¼å…¥
from config_reader import config

# å¯¹äº Secret* ç±»å‹çš„è®°å½•ï¼Œå¿…é¡»
# è°ƒç”¨ get_secret_value() æ–¹æ³•
# æ¥è·å–å®é™…å†…å®¹ï¼Œè€Œä¸æ˜¯ '*******'
bot = Bot(token=config.bot_token.get_secret_value())
```

æœ€åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ `.env` ï¼ˆæ–‡ä»¶å¼€å¤´æœ‰ä¸€ä¸ªç‚¹ï¼‰æ¥æè¿°æœºå™¨äººä»¤ç‰Œï¼š

```title=".env"
BOT_TOKEN = 0000000000:AaBbCcDdEeFfGgHhIiJjKkLlMmNn
```

å¦‚æœä¸€åˆ‡æ“ä½œæ­£ç¡®ï¼Œpython-dotenv å°†åœ¨å¯åŠ¨æ—¶ä» `.env` æ–‡ä»¶åŠ è½½å˜é‡ï¼Œpydantic å°†éªŒè¯è¿™äº›å˜é‡ï¼Œå¹¶ä½¿ç”¨æ‰€éœ€çš„ä»¤ç‰ŒæˆåŠŸåˆ›å»ºæœºå™¨äººå¯¹è±¡ã€‚

å…³äºè¯¥åº“çš„ä»‹ç»åˆ°æ­¤ä¸ºæ­¢ï¼Œåœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®º aiogram å’Œ Telegram Bot API çš„å…¶ä»– "åŠŸèƒ½"ã€‚
